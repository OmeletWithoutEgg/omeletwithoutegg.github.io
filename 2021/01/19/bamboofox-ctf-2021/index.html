<!doctype html><html lang=en-us data-theme=dark><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>BambooFox CTF 2021 | 蛋餅的競程隨筆</title><link rel=canonical href=https://omeletwithoutegg.github.io/2021/01/19/bamboofox-ctf-2021/><meta name=description content="一個廢人想寫題解，所以他想辦法弄網站"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://omeletwithoutegg.github.io/2021/01/19/bamboofox-ctf-2021/"><meta property="og:site_name" content="蛋餅的競程隨筆"><meta property="og:title" content="BambooFox CTF 2021"><meta property="og:description" content='BambooFox CTF 2021 這次是第二次參加BambooFox，不過事前都沒有做什麼練習wwww本來想說去OT之前推薦過的網站練習一些基礎，但是忘記是什麼網站了888
依然是跟joy一隊，然後另一個隊友變成casper了
今年似乎是大進步，不過我懷疑只是因為考很多演算法題orz
來講一些有解的題目，很抱歉我不知道怎麼讓我的code折疊起來XD
Gamer’s Cipher 一開場先開了 P versus ♯P，雖然查到解法可是精度跟速度都壓不過去，所以只好放棄改開別題。
然後第一個成功的題目就是Gamer’s Cipher這一題。
casper說看懂code就解完了（？）不過他沒辦法編譯所以也不知道怎麼辦。
總之我也跑去下載code看，然後查了好一下子怎麼編譯Haskell（記得編譯要加-dynamic的flag），成功編譯之後努力看懂code。
看起來像是用Nimber對字串加密，
明文和密文的長度都是$n=51$，然後他的key必須要是$n$階的原根，所以我寫了一個腳本看哪些是合法的key。
1 2 3 4 5 6 7 8 #!/bin/bash # search possible keys len=51 printf "len = %d\n" $len for i in $(seq 0 255); do echo $i printf "%51s\n%d\n" &#39;&#39; $i | tr " " "a" | ./Main 2>/dev/null >/dev/null && printf "i = %d\n\n" $i >> possible.txt done 但是關鍵的加密部份怎麼樣都不確定我看的對不對，所以我先把nimber的乘法表弄成一個文字檔存起來，再另外寫一個python跟Haskell的輸出比對
整理一下之後發現，欸這個式子不就是傅立葉轉換嗎？！（而且還是用Nimber做DFT，酷爆）就想說可能要用多項式插值或是寫inverse FFT
之後用python寫inverse DFT寫掉了，基本上只要把key的乘法反元素找出來帶進去傅立葉轉換的式子就好了'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-19T12:09:52+08:00"><meta property="article:modified_time" content="2021-01-19T12:09:52+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Experience"><meta name=twitter:card content="summary"><meta name=twitter:title content="BambooFox CTF 2021"><meta name=twitter:description content='BambooFox CTF 2021 這次是第二次參加BambooFox，不過事前都沒有做什麼練習wwww本來想說去OT之前推薦過的網站練習一些基礎，但是忘記是什麼網站了888
依然是跟joy一隊，然後另一個隊友變成casper了
今年似乎是大進步，不過我懷疑只是因為考很多演算法題orz
來講一些有解的題目，很抱歉我不知道怎麼讓我的code折疊起來XD
Gamer’s Cipher 一開場先開了 P versus ♯P，雖然查到解法可是精度跟速度都壓不過去，所以只好放棄改開別題。
然後第一個成功的題目就是Gamer’s Cipher這一題。
casper說看懂code就解完了（？）不過他沒辦法編譯所以也不知道怎麼辦。
總之我也跑去下載code看，然後查了好一下子怎麼編譯Haskell（記得編譯要加-dynamic的flag），成功編譯之後努力看懂code。
看起來像是用Nimber對字串加密，
明文和密文的長度都是$n=51$，然後他的key必須要是$n$階的原根，所以我寫了一個腳本看哪些是合法的key。
1 2 3 4 5 6 7 8 #!/bin/bash # search possible keys len=51 printf "len = %d\n" $len for i in $(seq 0 255); do echo $i printf "%51s\n%d\n" &#39;&#39; $i | tr " " "a" | ./Main 2>/dev/null >/dev/null && printf "i = %d\n\n" $i >> possible.txt done 但是關鍵的加密部份怎麼樣都不確定我看的對不對，所以我先把nimber的乘法表弄成一個文字檔存起來，再另外寫一個python跟Haskell的輸出比對
整理一下之後發現，欸這個式子不就是傅立葉轉換嗎？！（而且還是用Nimber做DFT，酷爆）就想說可能要用多項式插值或是寫inverse FFT
之後用python寫inverse DFT寫掉了，基本上只要把key的乘法反元素找出來帶進去傅立葉轉換的式子就好了'><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/styles.97348e5432bf92189089e1f8a6c5f5dc33c254e81647c2465d4512ef392867cb5f6d9083b3f4b189d4d36c82d2b1d9f5c02e4581fb2480b079162f3161266ab3.css integrity="sha512-lzSOVDK/khiQieH4psX13DPCVOgWR8JGXUUS7zkoZ8tfbZCDs/SxidTTbILSsdn1wC5FgfskgLB5Fi8xYSZqsw=="><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/highlight-block.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/highlight-code.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/search.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/toggle-switch.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://omeletwithoutegg.github.io/images/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-0ME10Z2L0D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0ME10Z2L0D")}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/resources/>Resources</a></li><li><a href=/search/>Search</a></li><li><a href=/tags/>Tags</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://omeletwithoutegg.github.io/2020/12/30/TIOJ-1597/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://omeletwithoutegg.github.io/2021/01/24/jngen/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&text=BambooFox%20CTF%202021" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&title=BambooFox%20CTF%202021" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&is_video=false&description=BambooFox%20CTF%202021" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=BambooFox%20CTF%202021&body=Check out this article: https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&title=BambooFox%20CTF%202021" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&title=BambooFox%20CTF%202021" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&name=BambooFox%20CTF%202021&description=%3ch1%20id%3d%22bamboofox-ctf-2021%22%3eBambooFox%20CTF%202021%3c%2fh1%3e%0a%3cp%3e%e9%80%99%e6%ac%a1%e6%98%af%e7%ac%ac%e4%ba%8c%e6%ac%a1%e5%8f%83%e5%8a%a0BambooFox%ef%bc%8c%e4%b8%8d%e9%81%8e%e4%ba%8b%e5%89%8d%e9%83%bd%e6%b2%92%e6%9c%89%e5%81%9a%e4%bb%80%e9%ba%bc%e7%b7%b4%e7%bf%92wwww%e6%9c%ac%e4%be%86%e6%83%b3%e8%aa%aa%e5%8e%bbOT%e4%b9%8b%e5%89%8d%e6%8e%a8%e8%96%a6%e9%81%8e%e7%9a%84%e7%b6%b2%e7%ab%99%e7%b7%b4%e7%bf%92%e4%b8%80%e4%ba%9b%e5%9f%ba%e7%a4%8e%ef%bc%8c%e4%bd%86%e6%98%af%e5%bf%98%e8%a8%98%e6%98%af%e4%bb%80%e9%ba%bc%e7%b6%b2%e7%ab%99%e4%ba%86888%3cbr%3e%0a%e4%be%9d%e7%84%b6%e6%98%af%e8%b7%9fjoy%e4%b8%80%e9%9a%8a%ef%bc%8c%e7%84%b6%e5%be%8c%e5%8f%a6%e4%b8%80%e5%80%8b%e9%9a%8a%e5%8f%8b%e8%ae%8a%e6%88%90casper%e4%ba%86%3c%2fp%3e%0a%3cp%3e%e4%bb%8a%e5%b9%b4%e4%bc%bc%e4%b9%8e%e6%98%af%e5%a4%a7%e9%80%b2%e6%ad%a5%ef%bc%8c%e4%b8%8d%e9%81%8e%e6%88%91%e6%87%b7%e7%96%91%e5%8f%aa%e6%98%af%e5%9b%a0%e7%82%ba%e8%80%83%e5%be%88%e5%a4%9a%e6%bc%94%e7%ae%97%e6%b3%95%e9%a1%8corz%3c%2fp%3e%0a%3cp%3e%e4%be%86%e8%ac%9b%e4%b8%80%e4%ba%9b%e6%9c%89%e8%a7%a3%e7%9a%84%e9%a1%8c%e7%9b%ae%ef%bc%8c%e5%be%88%e6%8a%b1%e6%ad%89%e6%88%91%e4%b8%8d%e7%9f%a5%e9%81%93%e6%80%8e%e9%ba%bc%e8%ae%93%e6%88%91%e7%9a%84code%e6%8a%98%e7%96%8a%e8%b5%b7%e4%be%86XD%3c%2fp%3e%0a%3ch2%20id%3d%22gamers-cipher%22%3eGamer%26rsquo%3bs%20Cipher%3c%2fh2%3e%0a%3cp%3e%e4%b8%80%e9%96%8b%e5%a0%b4%e5%85%88%e9%96%8b%e4%ba%86%20P%20versus%20%e2%99%afP%ef%bc%8c%e9%9b%96%e7%84%b6%e6%9f%a5%e5%88%b0%e8%a7%a3%e6%b3%95%e5%8f%af%e6%98%af%e7%b2%be%e5%ba%a6%e8%b7%9f%e9%80%9f%e5%ba%a6%e9%83%bd%e5%a3%93%e4%b8%8d%e9%81%8e%e5%8e%bb%ef%bc%8c%e6%89%80%e4%bb%a5%e5%8f%aa%e5%a5%bd%e6%94%be%e6%a3%84%e6%94%b9%e9%96%8b%e5%88%a5%e9%a1%8c%e3%80%82%3cbr%3e%0a%e7%84%b6%e5%be%8c%e7%ac%ac%e4%b8%80%e5%80%8b%e6%88%90%e5%8a%9f%e7%9a%84%e9%a1%8c%e7%9b%ae%e5%b0%b1%e6%98%afGamer%26rsquo%3bs%20Cipher%e9%80%99%e4%b8%80%e9%a1%8c%e3%80%82%3cbr%3e%0acasper%e8%aa%aa%e7%9c%8b%e6%87%82code%e5%b0%b1%e8%a7%a3%e5%ae%8c%e4%ba%86%ef%bc%88%ef%bc%9f%ef%bc%89%e4%b8%8d%e9%81%8e%e4%bb%96%e6%b2%92%e8%be%a6%e6%b3%95%e7%b7%a8%e8%ad%af%e6%89%80%e4%bb%a5%e4%b9%9f%e4%b8%8d%e7%9f%a5%e9%81%93%e6%80%8e%e9%ba%bc%e8%be%a6%e3%80%82%3cbr%3e%0a%e7%b8%bd%e4%b9%8b%e6%88%91%e4%b9%9f%e8%b7%91%e5%8e%bb%e4%b8%8b%e8%bc%89code%e7%9c%8b%ef%bc%8c%e7%84%b6%e5%be%8c%e6%9f%a5%e4%ba%86%e5%a5%bd%e4%b8%80%e4%b8%8b%e5%ad%90%e6%80%8e%e9%ba%bc%e7%b7%a8%e8%ad%afHaskell%ef%bc%88%e8%a8%98%e5%be%97%e7%b7%a8%e8%ad%af%e8%a6%81%e5%8a%a0%3ccode%3e-dynamic%3c%2fcode%3e%e7%9a%84flag%ef%bc%89%ef%bc%8c%e6%88%90%e5%8a%9f%e7%b7%a8%e8%ad%af%e4%b9%8b%e5%be%8c%e5%8a%aa%e5%8a%9b%e7%9c%8b%e6%87%82code%e3%80%82%3cbr%3e%0a%e7%9c%8b%e8%b5%b7%e4%be%86%e5%83%8f%e6%98%af%e7%94%a8%3ca%20href%3d%22https%3a%2f%2fen.wikipedia.org%2fwiki%2fNimber%22%3eNimber%3c%2fa%3e%e5%b0%8d%e5%ad%97%e4%b8%b2%e5%8a%a0%e5%af%86%ef%bc%8c%3cbr%3e%0a%e6%98%8e%e6%96%87%e5%92%8c%e5%af%86%e6%96%87%e7%9a%84%e9%95%b7%e5%ba%a6%e9%83%bd%e6%98%af%24n%3d51%24%ef%bc%8c%e7%84%b6%e5%be%8c%e4%bb%96%e7%9a%84key%e5%bf%85%e9%a0%88%e8%a6%81%e6%98%af%24n%24%e9%9a%8e%e7%9a%84%e5%8e%9f%e6%a0%b9%ef%bc%8c%e6%89%80%e4%bb%a5%e6%88%91%e5%af%ab%e4%ba%86%e4%b8%80%e5%80%8b%e8%85%b3%e6%9c%ac%e7%9c%8b%e5%93%aa%e4%ba%9b%e6%98%af%e5%90%88%e6%b3%95%e7%9a%84key%e3%80%82%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cdiv%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%0a%3ctable%20style%3d%22border-spacing%3a0%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%3ctr%3e%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e1%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e2%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e3%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e4%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e5%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e6%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e7%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e8%0a%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%0a%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%3bwidth%3a100%25%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-sh%22%20data-lang%3d%22sh%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%23%21%2fbin%2fbash%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%3c%2fspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%23%20search%20possible%20keys%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3elen%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23ae81ff%22%3e51%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3eprintf%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3blen%20%3d%20%25d%5cn%26%2334%3b%3c%2fspan%3e%20%24len%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3efor%3c%2fspan%3e%20i%20in%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3e%24%28%3c%2fspan%3eseq%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%20255%3cspan%20style%3d%22color%3a%2366d9ef%22%3e%29%3c%2fspan%3e%3b%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edo%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20echo%20%24i%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20printf%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b%2551s%5cn%25d%5cn%26%2334%3b%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%26%2339%3b%3c%2fspan%3e%20%24i%20%7c%20tr%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b%20%26%2334%3b%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3ba%26%2334%3b%3c%2fspan%3e%20%7c%20.%2fMain%202%26gt%3b%2fdev%2fnull%20%26gt%3b%2fdev%2fnull%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%26amp%3b%26amp%3b%3c%2fspan%3e%20printf%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bi%20%3d%20%25d%5cn%5cn%26%2334%3b%3c%2fspan%3e%20%24i%20%26gt%3b%26gt%3b%20possible.txt%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3edone%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%3c%2ftr%3e%3c%2ftable%3e%0a%3c%2fdiv%3e%0a%3c%2fdiv%3e%3cp%3e%e4%bd%86%e6%98%af%e9%97%9c%e9%8d%b5%e7%9a%84%e5%8a%a0%e5%af%86%e9%83%a8%e4%bb%bd%e6%80%8e%e9%ba%bc%e6%a8%a3%e9%83%bd%e4%b8%8d%e7%a2%ba%e5%ae%9a%e6%88%91%e7%9c%8b%e7%9a%84%e5%b0%8d%e4%b8%8d%e5%b0%8d%ef%bc%8c%e6%89%80%e4%bb%a5%e6%88%91%e5%85%88%e6%8a%8animber%e7%9a%84%e4%b9%98%e6%b3%95%e8%a1%a8%e5%bc%84%e6%88%90%e4%b8%80%e5%80%8b%e6%96%87%e5%ad%97%e6%aa%94%e5%ad%98%e8%b5%b7%e4%be%86%ef%bc%8c%e5%86%8d%e5%8f%a6%e5%a4%96%e5%af%ab%e4%b8%80%e5%80%8bpython%e8%b7%9fHaskell%e7%9a%84%e8%bc%b8%e5%87%ba%e6%af%94%e5%b0%8d%3cbr%3e%0a%e6%95%b4%e7%90%86%e4%b8%80%e4%b8%8b%e4%b9%8b%e5%be%8c%e7%99%bc%e7%8f%be%ef%bc%8c%e6%ac%b8%e9%80%99%e5%80%8b%e5%bc%8f%e5%ad%90%e4%b8%8d%e5%b0%b1%e6%98%af%e5%82%85%e7%ab%8b%e8%91%89%e8%bd%89%e6%8f%9b%e5%97%8e%ef%bc%9f%ef%bc%81%ef%bc%88%e8%80%8c%e4%b8%94%e9%82%84%e6%98%af%e7%94%a8Nimber%e5%81%9aDFT%ef%bc%8c%e9%85%b7%e7%88%86%ef%bc%89%e5%b0%b1%e6%83%b3%e8%aa%aa%e5%8f%af%e8%83%bd%e8%a6%81%e7%94%a8%e5%a4%9a%e9%a0%85%e5%bc%8f%e6%8f%92%e5%80%bc%e6%88%96%e6%98%af%e5%af%abinverse%20FFT%3cbr%3e%0a%e4%b9%8b%e5%be%8c%e7%94%a8python%e5%af%abinverse%20DFT%e5%af%ab%e6%8e%89%e4%ba%86%ef%bc%8c%e5%9f%ba%e6%9c%ac%e4%b8%8a%e5%8f%aa%e8%a6%81%e6%8a%8akey%e7%9a%84%e4%b9%98%e6%b3%95%e5%8f%8d%e5%85%83%e7%b4%a0%e6%89%be%e5%87%ba%e4%be%86%e5%b8%b6%e9%80%b2%e5%8e%bb%e5%82%85%e7%ab%8b%e8%91%89%e8%bd%89%e6%8f%9b%e7%9a%84%e5%bc%8f%e5%ad%90%e5%b0%b1%e5%a5%bd%e4%ba%86%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&t=BambooFox%20CTF%202021" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#gamers-cipher>Gamer&rsquo;s Cipher</a></li></ul><ul><li><ul><li><a href=#solvecpp>solve.cpp</a></li><li><a href=#solvepy>solve.py</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">BambooFox CTF 2021</h1><div class=meta><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>2qbingxuan&nbsp;</span></span><div class=postdate><time datetime="2021-01-19 12:09:52 +0800 +0800" itemprop=datePublished>2021-01-19</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/CTF/ rel=tag>CTF</a>
,
<a class=tag-link href=/tags/experience/ rel=tag>experience</a></div></div></header><div class=content itemprop=articleBody><h1 id=bamboofox-ctf-2021>BambooFox CTF 2021</h1><p>這次是第二次參加BambooFox，不過事前都沒有做什麼練習wwww本來想說去OT之前推薦過的網站練習一些基礎，但是忘記是什麼網站了888<br>依然是跟joy一隊，然後另一個隊友變成casper了</p><p>今年似乎是大進步，不過我懷疑只是因為考很多演算法題orz</p><p>來講一些有解的題目，很抱歉我不知道怎麼讓我的code折疊起來XD</p><h2 id=gamers-cipher>Gamer&rsquo;s Cipher</h2><p>一開場先開了 P versus ♯P，雖然查到解法可是精度跟速度都壓不過去，所以只好放棄改開別題。<br>然後第一個成功的題目就是Gamer&rsquo;s Cipher這一題。<br>casper說看懂code就解完了（？）不過他沒辦法編譯所以也不知道怎麼辦。<br>總之我也跑去下載code看，然後查了好一下子怎麼編譯Haskell（記得編譯要加<code>-dynamic</code>的flag），成功編譯之後努力看懂code。<br>看起來像是用<a href=https://en.wikipedia.org/wiki/Nimber>Nimber</a>對字串加密，<br>明文和密文的長度都是$n=51$，然後他的key必須要是$n$階的原根，所以我寫了一個腳本看哪些是合法的key。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e># search possible keys</span>
</span></span><span style=display:flex><span>len<span style=color:#f92672>=</span><span style=color:#ae81ff>51</span>
</span></span><span style=display:flex><span>printf <span style=color:#e6db74>&#34;len = %d\n&#34;</span> $len
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in <span style=color:#66d9ef>$(</span>seq <span style=color:#ae81ff>0</span> 255<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    echo $i
</span></span><span style=display:flex><span>    printf <span style=color:#e6db74>&#34;%51s\n%d\n&#34;</span> <span style=color:#e6db74>&#39;&#39;</span> $i | tr <span style=color:#e6db74>&#34; &#34;</span> <span style=color:#e6db74>&#34;a&#34;</span> | ./Main 2&gt;/dev/null &gt;/dev/null <span style=color:#f92672>&amp;&amp;</span> printf <span style=color:#e6db74>&#34;i = %d\n\n&#34;</span> $i &gt;&gt; possible.txt
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></td></tr></table></div></div><p>但是關鍵的加密部份怎麼樣都不確定我看的對不對，所以我先把nimber的乘法表弄成一個文字檔存起來，再另外寫一個python跟Haskell的輸出比對<br>整理一下之後發現，欸這個式子不就是傅立葉轉換嗎？！（而且還是用Nimber做DFT，酷爆）就想說可能要用多項式插值或是寫inverse FFT<br>之後用python寫inverse DFT寫掉了，基本上只要把key的乘法反元素找出來帶進去傅立葉轉換的式子就好了</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e># build multipication table</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Main.hs:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># main :: IO ()</span>
</span></span><span style=display:flex><span><span style=color:#75715e># main = do</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   a &lt;- readNim</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   b &lt;- readNim</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   print (a * b)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat /dev/null &gt; multable.txt
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in <span style=color:#66d9ef>$(</span>seq <span style=color:#ae81ff>0</span> 255<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    echo $i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j in <span style=color:#66d9ef>$(</span>seq <span style=color:#ae81ff>0</span> 255<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        printf <span style=color:#e6db74>&#34;%d\n%d\n&#34;</span> $i $j | ./Main &gt;&gt; multable.txt
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>A <span style=color:#f92672>=</span> [[<span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>)] <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;multable.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>            A[i][j] <span style=color:#f92672>=</span> int(f<span style=color:#f92672>.</span>readline())
</span></span><span style=display:flex><span><span style=color:#75715e># print(A)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>div</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>256</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> A[i][b] <span style=color:#f92672>==</span> a:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>mul</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> A[a][b]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add</span>(a, b):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a <span style=color:#f92672>^</span> b
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>power</span>(val, n):
</span></span><span style=display:flex><span>    <span style=color:#75715e># binpow?</span>
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> mul(res, val)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(&#34;div(1, 65) = &#34;, div(1, 65))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(&#34;div(1, 51) = &#34;, div(1, 51))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(message, key):
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> len(message)
</span></span><span style=display:flex><span>    pows <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> val: [power(val, i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n)]
</span></span><span style=display:flex><span>    keys <span style=color:#f92672>=</span> pows(key)
</span></span><span style=display:flex><span>    coef <span style=color:#f92672>=</span> [mul(message[i], keys[i]) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n)][::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n)]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>        s <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        pv <span style=color:#f92672>=</span> pows(keys[i])
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> add(s, mul(coef[j], pv[j]))
</span></span><span style=display:flex><span>        res[i] <span style=color:#f92672>=</span> add(keys[i], s)
</span></span><span style=display:flex><span>    print(coef)
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(res)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> res
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrypt</span>(res, key):
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> len(res)
</span></span><span style=display:flex><span>    pows <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span> val: [power(val, i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n)]
</span></span><span style=display:flex><span>    keys <span style=color:#f92672>=</span> pows(key)
</span></span><span style=display:flex><span>    <span style=color:#75715e># coef = [mul(message[i], keys[i]) for i in range(n)][::-1]</span>
</span></span><span style=display:flex><span>    coef <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n)];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>        pv <span style=color:#f92672>=</span> pows(keys[n<span style=color:#f92672>-</span>i <span style=color:#66d9ef>if</span> i <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> <span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>        s <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>            s <span style=color:#f92672>=</span> add(s, mul(add(res[j], keys[j]), pv[j]))
</span></span><span style=display:flex><span>            coef[i] <span style=color:#f92672>=</span> s
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(coef)</span>
</span></span><span style=display:flex><span>    message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>        message <span style=color:#f92672>+=</span> chr(div(coef[n<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>i], keys[i]))
</span></span><span style=display:flex><span>    print(message)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># t = encrypt([i for i in range(51)], 65)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># decrypt(t, 65)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># exit()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sec <span style=color:#f92672>=</span> [<span style=color:#ae81ff>13</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>114</span>,<span style=color:#ae81ff>230</span>,<span style=color:#ae81ff>244</span>,<span style=color:#ae81ff>145</span>,<span style=color:#ae81ff>218</span>,<span style=color:#ae81ff>78</span>,<span style=color:#ae81ff>204</span>,<span style=color:#ae81ff>36</span>,<span style=color:#ae81ff>81</span>,<span style=color:#ae81ff>48</span>,<span style=color:#ae81ff>148</span>,<span style=color:#ae81ff>35</span>,<span style=color:#ae81ff>40</span>,<span style=color:#ae81ff>50</span>,<span style=color:#ae81ff>78</span>,<span style=color:#ae81ff>40</span>,<span style=color:#ae81ff>88</span>,<span style=color:#ae81ff>43</span>,<span style=color:#ae81ff>122</span>,<span style=color:#ae81ff>39</span>,<span style=color:#ae81ff>41</span>,<span style=color:#ae81ff>149</span>,<span style=color:#ae81ff>208</span>,<span style=color:#ae81ff>208</span>,<span style=color:#ae81ff>191</span>,<span style=color:#ae81ff>68</span>,<span style=color:#ae81ff>65</span>,<span style=color:#ae81ff>61</span>,<span style=color:#ae81ff>224</span>,<span style=color:#ae81ff>140</span>,<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>239</span>,<span style=color:#ae81ff>104</span>,<span style=color:#ae81ff>210</span>,<span style=color:#ae81ff>110</span>,<span style=color:#ae81ff>119</span>,<span style=color:#ae81ff>178</span>,<span style=color:#ae81ff>27</span>,<span style=color:#ae81ff>173</span>,<span style=color:#ae81ff>253</span>,<span style=color:#ae81ff>15</span>,<span style=color:#ae81ff>237</span>,<span style=color:#ae81ff>85</span>,<span style=color:#ae81ff>192</span>,<span style=color:#ae81ff>82</span>,<span style=color:#ae81ff>74</span>,<span style=color:#ae81ff>148</span>,<span style=color:#ae81ff>15</span>,<span style=color:#ae81ff>250</span>]
</span></span><span style=display:flex><span><span style=color:#75715e># res = encrypt([ord(c) for c in input()], int(input()))</span>
</span></span><span style=display:flex><span>ks <span style=color:#f92672>=</span> [<span style=color:#ae81ff>102</span>, <span style=color:#ae81ff>122</span>, <span style=color:#ae81ff>125</span>, <span style=color:#ae81ff>132</span>, <span style=color:#ae81ff>140</span>, <span style=color:#ae81ff>147</span>, <span style=color:#ae81ff>150</span>, <span style=color:#ae81ff>154</span>, <span style=color:#ae81ff>159</span>, <span style=color:#ae81ff>166</span>, <span style=color:#ae81ff>172</span>, <span style=color:#ae81ff>176</span>, <span style=color:#ae81ff>180</span>, <span style=color:#ae81ff>187</span>, <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>195</span>, <span style=color:#ae81ff>196</span>, <span style=color:#ae81ff>200</span>, <span style=color:#ae81ff>207</span>, <span style=color:#ae81ff>213</span>, <span style=color:#ae81ff>216</span>, <span style=color:#ae81ff>225</span>, <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>242</span>, <span style=color:#ae81ff>244</span>, <span style=color:#ae81ff>251</span>, <span style=color:#ae81ff>253</span>, <span style=color:#ae81ff>65</span>, <span style=color:#ae81ff>69</span>, <span style=color:#ae81ff>83</span>, <span style=color:#ae81ff>86</span>, <span style=color:#ae81ff>96</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> ks:
</span></span><span style=display:flex><span>    decrypt(sec, k)
</span></span></code></pre></td></tr></table></div></div><h1 id=better-than-asm>Better than ASM</h1><p>這時候joy似乎在看交替看各題，casper在解verilog<br>然後我發現calc.exe有給source code很佛 :D 雖然是放在網頁隱藏的元素上面，不過點進去html就看得到了。但是不太知道要幹嘛。<br>只好交替看各題，看了reverse最後面這題給的檔案，把副檔名拿去google發現似乎是LLVM，而且跟wiki上面LLVM的中間語言，Intermediate Representation格式應該是吻合的。<br>執行<code>lli task.ll</code>可以執行這個bitcode，但是他就只是個會問你答不出來的問題的小壞蛋<br>畢竟我不會看這種很像組語的東西，所以就找一下有沒有轉換的工具，還真的在github上看到有llvm2c這個工具可以轉換成C語言，我還不star爆 XDD<br>換成C語言之後發現超多goto，不過其實都只是if跟for迴圈產生的goto而已，沒有特別混淆的感覺。<br>倒是變數用的超級多，大概是因為組語會把強制轉型跟那些暫時變數寫出來吧（例如算<code>(i+1)%n</code>就會<code>int var3 = i+1; var3 % n</code>或是複製一遍同樣的數字只是因為要轉unsigned）</p><p>總之他做的是只是<code>input -> validate -> win/fail</code>，他的win會要用到input的字串然後做一些加密還是hash的動作，而<code>validate</code>只是檢查input的兩兩相鄰字元是否跟某個常數陣列相符，所以我枚舉第一個字元就能得知整個字串，接著call <code>win</code>看輸出就可以找到flag了。老實說我一開始還以為做錯了，因為要從幾十個亂碼裡面找出合理的輸出比想像中難，何況他的flag還是用<a href=https://zh.wikipedia.org/zh-tw/Leet>Leetspeak</a>寫出來的XD怎麼找到的我都不知道。<br>下面是我最後化簡的code，全域的陣列大部份刪掉以便閱讀，可以看到main裡面還留了一些goto，基本上就只是在做for迴圈而已</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>// function declarations
</span></span></span><span style=display:flex><span><span style=color:#75715e>// extern unsigned int __isoc99_scanf(unsigned char* var0, ...);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>check</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> var0);
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// extern unsigned int printf(unsigned char* var0, ...);
</span></span></span><span style=display:flex><span><span style=color:#75715e>// extern unsigned long strlen(unsigned char* var0);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// global variable definitions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> format[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> flag[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> what[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> secret[<span style=color:#ae81ff>64</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> _str[<span style=color:#ae81ff>49</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> _str_1[<span style=color:#ae81ff>25</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> _str_2[<span style=color:#ae81ff>7</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> _str_3[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> _str_4[<span style=color:#ae81ff>81</span>] <span style=color:#f92672>=</span> { ... };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>check</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span><span style=color:#f92672>*</span> str){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> i;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>strlen</span>(what); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> a <span style=color:#f92672>=</span> str[i], b <span style=color:#f92672>=</span> str[(i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>%</span><span style=color:#a6e22e>strlen</span>(what)];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>((a <span style=color:#f92672>^</span> b) <span style=color:#f92672>!=</span> ((<span style=color:#66d9ef>int</span>)(what[i])))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> str[<span style=color:#ae81ff>64</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>solve</span>(<span style=color:#66d9ef>char</span> c) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> i, n <span style=color:#f92672>=</span> <span style=color:#a6e22e>strlen</span>(what);
</span></span><span style=display:flex><span>    str[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> c;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        str[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> str[i] <span style=color:#f92672>^</span> what[i];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    str[n] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// printf(&#34;%c\n%c\n&#34;, str[n-2], str[n-1]);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// puts(str);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// printf(&#34;%u\n&#34;, strlen(str));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>answer</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span> var1[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> var2;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span> var3;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> var4;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> var5;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> var6;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> var7;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> var8;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> var9;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> var10;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// printf(&amp;(_str[0]));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// printf(&amp;(_str_1[0]));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// printf(&amp;(_str_2[0]));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// puts(what);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// scanf(&amp;(_str_3[0]), &amp;(var1[0]));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    var4 <span style=color:#f92672>=</span> <span style=color:#a6e22e>strlen</span>(<span style=color:#f92672>&amp;</span>(var1[<span style=color:#ae81ff>0</span>]));
</span></span><span style=display:flex><span>    <span style=color:#75715e>// printf(&#34;input = %s\n&#34;, var1);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// printf(&#34;var4 = %d\n&#34;, (int)var4);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// printf(&#34;strlen(what) = %d\n&#34;, (int)strlen(what));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (var4 <span style=color:#f92672>!=</span> <span style=color:#a6e22e>strlen</span>(<span style=color:#f92672>&amp;</span>(what[<span style=color:#ae81ff>0</span>]))) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>printf</span>(<span style=color:#f92672>&amp;</span>(_str_4[<span style=color:#ae81ff>0</span>]));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>check</span>(<span style=color:#f92672>&amp;</span>(var1[<span style=color:#ae81ff>0</span>])) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// printf(&#34;Here!\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            var2 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> block4;
</span></span><span style=display:flex><span>            <span style=color:#75715e>// here is for loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            block4:
</span></span><span style=display:flex><span>            var5 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>long</span>)var2);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span>)var5) <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>strlen</span>(<span style=color:#f92672>&amp;</span>(var1[<span style=color:#ae81ff>0</span>]))) {
</span></span><span style=display:flex><span>                var6 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>int</span>)(var1[(<span style=color:#66d9ef>long</span>)var2]));
</span></span><span style=display:flex><span>                var7 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>long</span>)var2);
</span></span><span style=display:flex><span>                (var1[(<span style=color:#66d9ef>long</span>)var2]) <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)(var6 <span style=color:#f92672>^</span> ((<span style=color:#66d9ef>int</span>)(secret[((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span>)var7) <span style=color:#f92672>%</span> <span style=color:#a6e22e>strlen</span>(<span style=color:#f92672>&amp;</span>(secret[<span style=color:#ae81ff>0</span>]))]))));
</span></span><span style=display:flex><span>                var2 <span style=color:#f92672>=</span> (((<span style=color:#66d9ef>int</span>)var2) <span style=color:#f92672>+</span> ((<span style=color:#66d9ef>int</span>)<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>goto</span> block4;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;output = %s</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#34;</span>, var1);
</span></span><span style=display:flex><span>                <span style=color:#75715e>// printf(&amp;(format[0]), &amp;(var1[0]));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>            var3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>goto</span> block9;
</span></span><span style=display:flex><span>            <span style=color:#75715e>// here is for loop
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            block9:
</span></span><span style=display:flex><span>            var8 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>long</span>)var3);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span>)var8) <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>strlen</span>(<span style=color:#f92672>&amp;</span>(var1[<span style=color:#ae81ff>0</span>]))) {
</span></span><span style=display:flex><span>                var9 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>int</span>)(flag[(<span style=color:#66d9ef>long</span>)var3]));
</span></span><span style=display:flex><span>                var10 <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>long</span>)var3);
</span></span><span style=display:flex><span>                (var1[(<span style=color:#66d9ef>long</span>)var3]) <span style=color:#f92672>=</span> ((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)(var9 <span style=color:#f92672>^</span> ((<span style=color:#66d9ef>int</span>)(secret[((<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span>)var10) <span style=color:#f92672>%</span> <span style=color:#a6e22e>strlen</span>(<span style=color:#f92672>&amp;</span>(secret[<span style=color:#ae81ff>0</span>]))]))));
</span></span><span style=display:flex><span>                var3 <span style=color:#f92672>=</span> (((<span style=color:#66d9ef>int</span>)var3) <span style=color:#f92672>+</span> ((<span style=color:#66d9ef>int</span>)<span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>goto</span> block9;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>printf</span>(<span style=color:#f92672>&amp;</span>(format[<span style=color:#ae81ff>0</span>]), <span style=color:#f92672>&amp;</span>(var1[<span style=color:#ae81ff>0</span>]));
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>(<span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>128</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>solve</span>(i);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>answer</span>(str);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h1 id=calcexe-online>Calc.exe online</h1><p>不久之後casper把verilog(flag checker)給做出來了<br>我也弄出來說<code>sin[0]</code>會跑出s這個字串（不記得是google還是試出來的了）<br>然後Google發現大概是webshell這個主題，接著又找到可以用<code>('system')()</code>之類的方法執行函數，我就照著找到的東西試試看<code>('phpinfo')()</code>，<br>然後真的跑出東西了XD<br>但是我很多字元弄不出來，後來查到可以用<code>chr</code>這個函數，就能成功湊出所有的字元啦！<br>不過我不知道flag在哪裡，所以執行了<code>('system')('find / -name "flag*')</code>找到flag在哪裡，最後執行了<code>('system')('cat /flag*')</code>得到flag的內容<br>下面是我最後拿來湊出字元的腳本</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>good <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;abs&#39;</span>, <span style=color:#e6db74>&#39;acos&#39;</span>, <span style=color:#e6db74>&#39;acosh&#39;</span>, <span style=color:#e6db74>&#39;asin&#39;</span>, <span style=color:#e6db74>&#39;asinh&#39;</span>, <span style=color:#e6db74>&#39;atan2&#39;</span>, <span style=color:#e6db74>&#39;atan&#39;</span>, <span style=color:#e6db74>&#39;atanh&#39;</span>, <span style=color:#e6db74>&#39;base_convert&#39;</span>, <span style=color:#e6db74>&#39;bindec&#39;</span>, <span style=color:#e6db74>&#39;ceil&#39;</span>, <span style=color:#e6db74>&#39;cos&#39;</span>, <span style=color:#e6db74>&#39;cosh&#39;</span>, <span style=color:#e6db74>&#39;decbin&#39;</span>, <span style=color:#e6db74>&#39;dechex&#39;</span>, <span style=color:#e6db74>&#39;decoct&#39;</span>, <span style=color:#e6db74>&#39;deg2rad&#39;</span>, <span style=color:#e6db74>&#39;exp&#39;</span>, <span style=color:#e6db74>&#39;floor&#39;</span>, <span style=color:#e6db74>&#39;fmod&#39;</span>, <span style=color:#e6db74>&#39;getrandmax&#39;</span>, <span style=color:#e6db74>&#39;hexdec&#39;</span>, <span style=color:#e6db74>&#39;hypot&#39;</span>, <span style=color:#e6db74>&#39;is_finite&#39;</span>, <span style=color:#e6db74>&#39;is_infinite&#39;</span>, <span style=color:#e6db74>&#39;is_nan&#39;</span>, <span style=color:#e6db74>&#39;lcg_value&#39;</span>, <span style=color:#e6db74>&#39;log10&#39;</span>, <span style=color:#e6db74>&#39;log&#39;</span>, <span style=color:#e6db74>&#39;max&#39;</span>, <span style=color:#e6db74>&#39;min&#39;</span>, <span style=color:#e6db74>&#39;mt_getrandmax&#39;</span>, <span style=color:#e6db74>&#39;mt_rand&#39;</span>, <span style=color:#e6db74>&#39;octdec&#39;</span>, <span style=color:#e6db74>&#39;pi&#39;</span>, <span style=color:#e6db74>&#39;pow&#39;</span>, <span style=color:#e6db74>&#39;rad2deg&#39;</span>, <span style=color:#e6db74>&#39;rand&#39;</span>, <span style=color:#e6db74>&#39;round&#39;</span>, <span style=color:#e6db74>&#39;sin&#39;</span>, <span style=color:#e6db74>&#39;sinh&#39;</span>, <span style=color:#e6db74>&#39;sqrt&#39;</span>, <span style=color:#e6db74>&#39;srand&#39;</span>, <span style=color:#e6db74>&#39;tan&#39;</span>, <span style=color:#e6db74>&#39;tanh&#39;</span>, <span style=color:#e6db74>&#39;ncr&#39;</span>, <span style=color:#e6db74>&#39;npr&#39;</span>, <span style=color:#e6db74>&#39;number_format&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mp <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> s <span style=color:#f92672>in</span> good:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(len(s)):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> s[j] <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> mp <span style=color:#f92672>or</span> len(mp[s[j]]) <span style=color:#f92672>&gt;</span> len(s)<span style=color:#f92672>+</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span>len(str(j)):
</span></span><span style=display:flex><span>            mp[s[j]] <span style=color:#f92672>=</span> s <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;[&#39;</span> <span style=color:#f92672>+</span> str(j) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(mp)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>solve</span>(s):
</span></span><span style=display:flex><span>    ret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>    first <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> s:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> first:
</span></span><span style=display:flex><span>            ret <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#39;.&#39;</span>
</span></span><span style=display:flex><span>        first <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> c <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> mp:
</span></span><span style=display:flex><span>            ret <span style=color:#f92672>+=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;((</span><span style=color:#e6db74>{</span>solve(<span style=color:#e6db74>&#34;chr&#34;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>)(</span><span style=color:#e6db74>{</span>ord(c)<span style=color:#e6db74>}</span><span style=color:#e6db74>))&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            ret <span style=color:#f92672>+=</span> mp[c]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> ret
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(&#39;(&#39; + solve(&#39;system&#39;) + &#39;)&#39; + &#39;(&#39; + solve(&#39;find / -name flag*&#39;) + &#39;)&#39;) # call (&#39;system&#39;)(&#39;ls&#39;)</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;(&#39;</span> <span style=color:#f92672>+</span> solve(<span style=color:#e6db74>&#39;system&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;)&#39;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;(&#39;</span> <span style=color:#f92672>+</span> solve(<span style=color:#e6db74>&#39;cat /flag*&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;)&#39;</span>) <span style=color:#75715e># call (&#39;system&#39;)(&#39;ls&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(solve(&#39;echo&#39;))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(solve(&#39;getallheaders&#39;))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(solve(&#39;system&#39;))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(solve(&#39;ls&#39;))</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=p-versus-p>P versus ♯P</h1><p>接下來我基本上通宵都在弄這題。我覺得這題很有趣，題目是server會丟給你一個有障礙物的棋盤方格，簡單版本是問是否可以用1x2的骨牌蓋滿而困難版本是問有幾種方法。<br>這個之前蕭梓宏好像講過，所以我知道他是可作的，就是平面圖的完美匹配個數。google之後找到CSDN有現成的code，先感謝owo<br>不過可惜他是對998244353 mod，而且加邊的方式也有些不同，所以我稍微改了一下code，改成日月卦長的大數，不過速度真的很慢，超級慢QQ<br>我猜是因為途中數字會變超大所以速度就燒雞。我找各種python的套件要高精度快速做矩陣行列式的都找不到可以用的QQ所以我最後決定用中國剩餘定理，選夠多的質數算XD<br>這樣行列式還是算的頗慢，大概在12~13筆就會卡住了，於是就卡關跑去解Gamer&rsquo;s Cipher和別題。</p><p>晚上的時候想到這張圖是平面圖，因此矩陣是稀疏的，跑去github上面找了稀疏矩陣行列式，還真的有XD <a href=https://github.com/yosupo06/library-checker-problems/blob/master/math/sparse_matrix_det/sol/correct.cpp>真香</a> 而且作法還是跟之前看過得中國IOI國家隊論文寫的一樣XDD<br>所以就套上去，但是但是！這樣還是不夠快，時間已經到了隔天凌晨七點，我嘗試最後一次後就把檔案丟給隊友倒下去了。<br>起床是十二點多，最後我是又找到另外一個github上面的 <a href=https://gist.github.com/simonlindholm/51f88e9626408723cf906c6debd3814b>code</a> 可以加速同餘下的乘法才終於成功把時間壓到範圍內，做出來真的成就感滿滿。</p><p>我最後的code有點長，之後再考慮另外放好了</p><h1 id=ransomware>Ransomware</h1><p>The vault是web assembly，被casper解決掉。同時joy也催促（？）我解這題，雖然他已經剩下50分了QQ<br>總之他給了.pyc檔跟一個<code>flag.enc</code>的檔案，把byte code用工具（decompyle之類的，不知道版本重不重要，不過以magic numbe來看這個.pyc似乎是3.8）轉回來.py之後就可以輕鬆知道他是把<code>flag.png</code>以官方網頁上面的文字當作金鑰用AES加密成<code>flag.enc</code>，<br>用同一個套件解密後得到<code>flag.png</code>寫著the flag is after this image，我一頭霧水丟給joy他就直接找出真正的flagㄌ，似乎是兩張png黏在一起的梗。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># decompyle3 version 3.3.2</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Python bytecode 3.8 (3413)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Decompiled from: Python 3.8.0 (default, Jan 17 2021, 16:18:58) </span>
</span></span><span style=display:flex><span><span style=color:#75715e># [GCC 10.2.0]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Embedded file name: task.py</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Compiled at: 2021-01-14 22:13:24</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Size of source mod 2**32: 420 bytes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># def func(key, iv, data, AES):</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     open(&#39;flag.enc&#39;, &#39;wb&#39;).write(AES.new(key, AES.MODE_CBC, iv).encrypt(lambda x: x + b&#39;\x00&#39; * (16 - len(x) % 16)(data)))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decrpt</span>(key, iv, AES):
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC, iv)
</span></span><span style=display:flex><span>    raw <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;flag.enc&#39;</span>, <span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    print(len(raw))
</span></span><span style=display:flex><span>    open(<span style=color:#e6db74>&#39;flag.png&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>)<span style=color:#f92672>.</span>write(cipher<span style=color:#f92672>.</span>decrypt(raw))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> __import__(<span style=color:#e6db74>&#39;requests&#39;</span>)<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;https://ctf.bamboofox.tw/rules&#39;</span>)<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>encode()
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> <span style=color:#ae81ff>99</span>
</span></span><span style=display:flex><span>iv <span style=color:#f92672>=</span> <span style=color:#ae81ff>153</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># func(data[key:key + 16], data[iv:iv + 16], open(&#39;flag.png&#39;, &#39;rb&#39;).read(), __import__(&#39;Crypto.Cipher.AES&#39;).Cipher.AES) if len(data) != 0 else lambda fn: __import__(&#39;os&#39;).remove(fn)(&#39;task.py&#39;))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>decrpt(data[key:key<span style=color:#f92672>+</span><span style=color:#ae81ff>16</span>], data[iv:iv<span style=color:#f92672>+</span><span style=color:#ae81ff>16</span>], AES)
</span></span><span style=display:flex><span><span style=color:#75715e># okay decompiling task.pyc</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=orz-network>orz Network</h1><p>被casper丟了這題，他說這是質數什麼的題目應該交給我<br>看起來像是隨便找一棵生成樹然後把每條邊都解密就可以了，他使用的加密方法是Diffie-Hellman，去維基百科可以翻到公鑰與私鑰各自的定義。<br>總之，要求私鑰我們就必須求離散對數，但是他的數字範圍給到10^18而且有419個數字要解，很明顯不能直接大步小步做完，<br>經過一番google，我發現了Pohlig-Hellman algorithm，是可以在大約sqrt(p)的量級解離散對數，其中p是mod的phi值（=mod-1）的最大質因數。因為完全沒有找到C++的code所以我自己按照維基上面的敘述刻，花了一段時間之後可以在合理的時間內解出某條邊了。<br>接下來就找生成樹然後對那些邊解密就對了。這題比前面幾題的演算法題簡單多了，雖然還是套了一大堆模板XDD<br>直接去抄waynedisonitau123的Pollard-Rho還有Millar-Rabin好爽喔XDDD<br>然後大步小步跟中國剩餘也都不用自己寫，對打高中競程的人來說真的是夢幻待遇(X</p><h3 id=solvecpp>solve.cpp</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">199
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/extc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> LLL <span style=color:#f92672>=</span> __int128;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ll <span style=color:#a6e22e>modpow</span>(ll e, ll p, ll m) {
</span></span><span style=display:flex><span>    ll r <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(p) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(p <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) r <span style=color:#f92672>=</span> (LLL)r <span style=color:#f92672>*</span> e <span style=color:#f92672>%</span> m;
</span></span><span style=display:flex><span>        e <span style=color:#f92672>=</span> (LLL) e <span style=color:#f92672>*</span> e <span style=color:#f92672>%</span> m;
</span></span><span style=display:flex><span>        p <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> r;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ll <span style=color:#a6e22e>modmul</span>(ll a, ll b, ll m) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (LLL) a <span style=color:#f92672>*</span> b <span style=color:#f92672>%</span> m;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Factorization</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>MillerRabin</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// n &lt; 4759123141     chk = [2, 7, 61]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// n &lt; 1122004669633  chk = [2, 13, 23, 1662803]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// n &lt; 2^64           chk = [2, 325, 9375, 28178, 450775, 9780504, 1795265022]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span><span style=color:#f92672>&gt;</span> chk <span style=color:#f92672>=</span> {<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>325</span>,<span style=color:#ae81ff>9375</span>,<span style=color:#ae81ff>28178</span>,<span style=color:#ae81ff>450775</span>,<span style=color:#ae81ff>9780504</span>,<span style=color:#ae81ff>1795265022</span>};
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>Check</span>(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> a, <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> u, <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> n, <span style=color:#66d9ef>int</span> t) {
</span></span><span style=display:flex><span>            a <span style=color:#f92672>=</span> modpow(a, u, n);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> a <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> a <span style=color:#f92672>==</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> t; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>                a <span style=color:#f92672>=</span> modmul(a, a, n);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (a <span style=color:#f92672>==</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>bool</span> <span style=color:#a6e22e>operator</span>()(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> n) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (n <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (n <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> n <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> u <span style=color:#f92672>=</span> n <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#66d9ef>int</span> t <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (; <span style=color:#f92672>!</span>(u <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>); u <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>, <span style=color:#f92672>++</span>t);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> i : chk) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>Check(i, u, n, t)) <span style=color:#66d9ef>return</span> false;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> true;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } prime;
</span></span><span style=display:flex><span>    map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> cnt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>pollardRho</span>(<span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> n) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (n <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (prime(n)) <span style=color:#66d9ef>return</span> <span style=color:#f92672>++</span>cnt[n], <span style=color:#66d9ef>void</span>();        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (n <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span> pollardRho(n <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>), <span style=color:#f92672>++</span>cnt[<span style=color:#ae81ff>2</span>], <span style=color:#66d9ef>void</span>();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> x <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>, y <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>, d <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, p <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> f <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>auto</span> x, <span style=color:#66d9ef>auto</span> n, <span style=color:#66d9ef>int</span> p) { <span style=color:#66d9ef>return</span> (modmul(x, x, n) <span style=color:#f92672>+</span> p) <span style=color:#f92672>%</span> n; };
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (true) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (d <span style=color:#f92672>!=</span> n <span style=color:#f92672>&amp;&amp;</span> d <span style=color:#f92672>!=</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                pollardRho(n <span style=color:#f92672>/</span> d);
</span></span><span style=display:flex><span>                pollardRho(d);
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (d <span style=color:#f92672>==</span> n) <span style=color:#f92672>++</span>p;
</span></span><span style=display:flex><span>            x <span style=color:#f92672>=</span> f(x, n, p); y <span style=color:#f92672>=</span> f(f(y, n, p), n, p);
</span></span><span style=display:flex><span>            d <span style=color:#f92672>=</span> __gcd(abs(x <span style=color:#f92672>-</span> y), n);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    ll <span style=color:#a6e22e>mxPrime</span>(ll n) {
</span></span><span style=display:flex><span>        ll mx <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        cnt.clear();
</span></span><span style=display:flex><span>        pollardRho(n);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> [a, b]<span style=color:#f92672>:</span> cnt) mx <span style=color:#f92672>=</span> max(mx, a);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> mx;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} factor;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>CRT</span> {
</span></span><span style=display:flex><span>    ll R, M;
</span></span><span style=display:flex><span>    CRT() <span style=color:#f92672>:</span> R(<span style=color:#ae81ff>0</span>), M(<span style=color:#ae81ff>1</span>) {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> tuple<span style=color:#f92672>&lt;</span>T, T, T<span style=color:#f92672>&gt;</span> extgcd(T a, T b) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>b) <span style=color:#66d9ef>return</span> make_tuple(a, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        T d, x, y;
</span></span><span style=display:flex><span>        tie(d, x, y) <span style=color:#f92672>=</span> extgcd(b, a <span style=color:#f92672>%</span> b);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>make_tuple</span>(d, y, x <span style=color:#f92672>-</span> (a <span style=color:#f92672>/</span> b) <span style=color:#f92672>*</span> y);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>add</span>(ll r, ll m) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> d, x, y; 
</span></span><span style=display:flex><span>        tie(d, x, y) <span style=color:#f92672>=</span> extgcd(M, m <span style=color:#f92672>*</span> <span style=color:#ae81ff>1ll</span>);
</span></span><span style=display:flex><span>        assert ((r <span style=color:#f92672>-</span> R) <span style=color:#f92672>%</span> d <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span> new_M <span style=color:#f92672>=</span> M <span style=color:#f92672>/</span> __gcd(M, <span style=color:#ae81ff>1ll</span> <span style=color:#f92672>*</span> m) <span style=color:#f92672>*</span> m; 
</span></span><span style=display:flex><span>        R <span style=color:#f92672>+=</span> modmul(modmul(x, (r <span style=color:#f92672>-</span> R) <span style=color:#f92672>/</span> d, new_M), M, new_M);
</span></span><span style=display:flex><span>        M <span style=color:#f92672>=</span> new_M;
</span></span><span style=display:flex><span>        ((R <span style=color:#f92672>%=</span> M) <span style=color:#f92672>+=</span> M) <span style=color:#f92672>%=</span> M;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    pair<span style=color:#f92672>&lt;</span>ll,ll<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>operator</span>()() <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> {R, M};
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ll <span style=color:#a6e22e>BSGS</span>(ll a, ll b, ll m, ll T) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// a^x = b (mod m), and T is the period
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ll n <span style=color:#f92672>=</span> sqrt(T) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ll an <span style=color:#f92672>=</span> modpow(a, n, m);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    unordered_map<span style=color:#f92672>&lt;</span>ll, ll<span style=color:#f92672>&gt;</span> vals;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (ll q <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, cur <span style=color:#f92672>=</span> b; q <span style=color:#f92672>&lt;=</span> n; <span style=color:#f92672>++</span>q) {
</span></span><span style=display:flex><span>        vals[cur] <span style=color:#f92672>=</span> q;
</span></span><span style=display:flex><span>        cur <span style=color:#f92672>=</span> ((LLL) cur <span style=color:#f92672>*</span> a) <span style=color:#f92672>%</span> m;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// std::cerr &lt;&lt; &#34;q = &#34; &lt;&lt; q &lt;&lt; &#39;\n&#39;;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (ll p <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, cur <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; p <span style=color:#f92672>&lt;=</span> n; <span style=color:#f92672>++</span>p) {
</span></span><span style=display:flex><span>        cur <span style=color:#f92672>=</span> ((LLL) cur <span style=color:#f92672>*</span> an) <span style=color:#f92672>%</span> m;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (vals.count(cur)) {
</span></span><span style=display:flex><span>            ll ans <span style=color:#f92672>=</span> n <span style=color:#f92672>*</span> p <span style=color:#f92672>-</span> vals[cur];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> ans;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;a = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> a <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; b = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> b <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; m = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> m <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34; T = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> T <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>    cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;NOT FOUND</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    exit(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> __gnu_cxx<span style=color:#f92672>::</span>power;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ll <span style=color:#a6e22e>discreteLog</span>(ll a, ll b, ll m) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// m is prime
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>auto</span> solve <span style=color:#f92672>=</span> [m](ll g, ll h, ll p, ll e) {
</span></span><span style=display:flex><span>        ll x <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        ll r <span style=color:#f92672>=</span> modpow(g, power(p, e<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>), m);
</span></span><span style=display:flex><span>        ll invg <span style=color:#f92672>=</span> modpow(g, m<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>, m);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k <span style=color:#f92672>&lt;</span> e; k<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            ll hk <span style=color:#f92672>=</span> modpow(modmul(modpow(invg, x, m), h, m), power(p, e<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>k), m);
</span></span><span style=display:flex><span>            ll d <span style=color:#f92672>=</span> BSGS(r, hk, m, p);
</span></span><span style=display:flex><span>            x <span style=color:#f92672>+=</span> power(p, k) <span style=color:#f92672>*</span> d;
</span></span><span style=display:flex><span>            <span style=color:#75715e>// cerr&lt;&lt;&#34;k = &#34;&lt;&lt;k&lt;&lt;&#34; ; &#34;;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        <span style=color:#75715e>// cerr &lt;&lt; &#39;\n&#39;;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    ll phi <span style=color:#f92672>=</span> m<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    CRT crt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> [p, e]<span style=color:#f92672>:</span> factor.cnt) {
</span></span><span style=display:flex><span>        ll P <span style=color:#f92672>=</span> power(p, e);
</span></span><span style=display:flex><span>        ll X <span style=color:#f92672>=</span> solve(modpow(a, phi <span style=color:#f92672>/</span> P, m), modpow(b, phi <span style=color:#f92672>/</span> P, m), p, e);
</span></span><span style=display:flex><span>        crt.add(X, P);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    assert(crt().second <span style=color:#f92672>==</span> phi);
</span></span><span style=display:flex><span>    assert(modpow(a, crt().first, m) <span style=color:#f92672>==</span> b);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> crt().first;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Edge</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> j;
</span></span><span style=display:flex><span>    ll m, g, A, B;
</span></span><span style=display:flex><span>    Edge(<span style=color:#66d9ef>int</span> j, ll m, ll g, ll A, ll B) <span style=color:#f92672>:</span> j(j), m(m), g(g), A(A), B(B) {}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>signed</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;solve.cpp::main() start.</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    ios_base<span style=color:#f92672>::</span>sync_with_stdio(<span style=color:#ae81ff>0</span>), cin.tie(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> <span style=color:#ae81ff>420</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> a, b;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span>Edge<span style=color:#f92672>&gt;&gt;</span> adj(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(cin <span style=color:#f92672>&gt;&gt;</span> a <span style=color:#f92672>&gt;&gt;</span> b) {
</span></span><span style=display:flex><span>        assert(<span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;=</span> a <span style=color:#f92672>&amp;&amp;</span> a <span style=color:#f92672>&lt;=</span> n <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;=</span> b <span style=color:#f92672>&amp;&amp;</span> b <span style=color:#f92672>&lt;=</span> n <span style=color:#f92672>&amp;&amp;</span> a <span style=color:#f92672>!=</span> b);
</span></span><span style=display:flex><span>        ll m, g, A, B;
</span></span><span style=display:flex><span>        cin <span style=color:#f92672>&gt;&gt;</span> m <span style=color:#f92672>&gt;&gt;</span> g <span style=color:#f92672>&gt;&gt;</span> A <span style=color:#f92672>&gt;&gt;</span> B;
</span></span><span style=display:flex><span>        <span style=color:#f92672>--</span>a, <span style=color:#f92672>--</span>b;
</span></span><span style=display:flex><span>        adj[a].emplace_back(b, m, g, A, B);
</span></span><span style=display:flex><span>        adj[b].emplace_back(a, m, g, B, A);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>ll<span style=color:#f92672>&gt;</span> ans;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> vis(n);
</span></span><span style=display:flex><span>    function<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>void</span>(<span style=color:#66d9ef>int</span>)<span style=color:#f92672>&gt;</span> dfs <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> i) {
</span></span><span style=display:flex><span>        vis[i] <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>auto</span> [j, m, g, A, B]<span style=color:#f92672>:</span> adj[i]) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(vis[j]) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(factor.mxPrime(m<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1e15</span>) {
</span></span><span style=display:flex><span>                cerr <span style=color:#f92672>&lt;&lt;</span> m<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#75715e>// cerr &lt;&lt; A &lt;&lt; &#39; &#39; &lt;&lt; B &lt;&lt; &#39;\n&#39;;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            ll sa <span style=color:#f92672>=</span> discreteLog(g, A, m);
</span></span><span style=display:flex><span>            ll sb <span style=color:#f92672>=</span> discreteLog(g, B, m);
</span></span><span style=display:flex><span>            assert(modpow(g, sa, m) <span style=color:#f92672>==</span> A <span style=color:#f92672>&amp;&amp;</span> modpow(g, sb, m) <span style=color:#f92672>==</span> B);
</span></span><span style=display:flex><span>            ans.emplace_back(modpow(A, sb, m));
</span></span><span style=display:flex><span>            <span style=color:#75715e>// cerr &lt;&lt; ans.back() &lt;&lt; &#39;\n&#39;;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            dfs(j);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    dfs(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    std<span style=color:#f92672>::</span>cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;ans.size() = &#34;</span> <span style=color:#f92672>&lt;&lt;</span> ans.size() <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>    assert(ans.size() <span style=color:#f92672>==</span> n<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(ll x: ans)
</span></span><span style=display:flex><span>        cout <span style=color:#f92672>&lt;&lt;</span> x <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=solvepy>solve.py</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> socket
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;chall.ctf.bamboofox.tw&#34;</span>
</span></span><span style=display:flex><span>port <span style=color:#f92672>=</span> <span style=color:#ae81ff>10369</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s <span style=color:#f92672>=</span> socket<span style=color:#f92672>.</span>socket(socket<span style=color:#f92672>.</span>AF_INET, socket<span style=color:#f92672>.</span>SOCK_STREAM)
</span></span><span style=display:flex><span>s<span style=color:#f92672>.</span>connect((host, port))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;connect success&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>pow_solver</span>(prefix, difficulty):
</span></span><span style=display:flex><span>    zeros <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>*</span> difficulty
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_valid</span>(digest):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> sys<span style=color:#f92672>.</span>version_info<span style=color:#f92672>.</span>major <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>            digest <span style=color:#f92672>=</span> [ord(i) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> digest]
</span></span><span style=display:flex><span>        bits <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(bin(i)[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>zfill(<span style=color:#ae81ff>8</span>) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> digest)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> bits[:difficulty] <span style=color:#f92672>==</span> zeros
</span></span><span style=display:flex><span>    i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        s <span style=color:#f92672>=</span> prefix <span style=color:#f92672>+</span> str(i)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> is_valid(hashlib<span style=color:#f92672>.</span>sha256(s<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>digest()):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;main start&#39;</span>)
</span></span><span style=display:flex><span>    question <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>4096</span>)
</span></span><span style=display:flex><span>    question <span style=color:#f92672>=</span> question<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;ascii&#39;</span>)
</span></span><span style=display:flex><span>    print(question)
</span></span><span style=display:flex><span>    question <span style=color:#f92672>=</span> question[<span style=color:#ae81ff>58</span>:<span style=color:#ae81ff>74</span>]
</span></span><span style=display:flex><span>    print(question)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>=</span> pow_solver(question, <span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>    print(str(ans) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>send(bytes(str(ans) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>    _ <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>4096</span>)
</span></span><span style=display:flex><span>    print(_<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>send(bytes(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;utf-8&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;edges.txt&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>            _ <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>4096</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> len(_) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>            content <span style=color:#f92672>=</span> _<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;ascii&#39;</span>)
</span></span><span style=display:flex><span>            <span style=color:#75715e># print(content)</span>
</span></span><span style=display:flex><span>            content <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>sub(<span style=color:#e6db74>&#34;[^\d\s]&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>, content)
</span></span><span style=display:flex><span>            f<span style=color:#f92672>.</span>write(content)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> _<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;ascii&#39;</span>)<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;Enter&#34;</span>) <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>system(<span style=color:#e6db74>&#34;./solve &lt; edges.txt &gt; ans.txt&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;ans.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines();
</span></span><span style=display:flex><span>        print(ans, len(ans))
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join([x<span style=color:#f92672>.</span>strip() <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> ans])
</span></span><span style=display:flex><span>    print(ans)
</span></span><span style=display:flex><span>    s<span style=color:#f92672>.</span>send(bytes(str(ans) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>recv(<span style=color:#ae81ff>1024</span>)
</span></span><span style=display:flex><span>    print(res<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#75715e># os.system(&#34;./solve&#34;)</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>main()
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>g++ solve.cpp -o solve -std<span style=color:#f92672>=</span>c++17
</span></span><span style=display:flex><span>python solve.py
</span></span></code></pre></td></tr></table></div></div><h1 id=after-that>After that</h1><p>接下來我又花了一個半夜去嘗試Web題<br>time to draw看起來就是要對那個api做怪事情，但我整個方向錯誤了，我誤以為是要XSS所以瘋狂送<code>color={"match": "function() { ... }"}</code>的請求，但其實根本沒辦法執行這字串裡面的東西QQ<br>我也有看表情符號那一題，但是實在對PHP太陌生了，我現在連官方解答都不知道為什麼會對，他不是會檢查長度嗎？？？<br>總之，我覺得我們web跟pwn太弱了（或者說這次出的都是演算法題XD）<br>不知道這種injection應該如何練習是好(X</p><p>最後名次是12名，跟去年比起來進步不只一半<br>而且意外的是我們是台灣前三名所以可以拿獎金耶，超爽der<br>明年不意外應該也是會來玩ㄅ，不過如果問我途中會不會認真學大概就是不會吧owo<br>打CTF真的很讓人享受解謎（？）的過程，不過也可能只是因為解的出來才享受吧。另外打CTF還有一個優點就是不會被ZCK電爛很開心(X</p></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="omeletwithoutegg",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/resources/>Resources</a></li><li><a href=/search/>Search</a></li><li><a href=/tags/>Tags</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#gamers-cipher>Gamer&rsquo;s Cipher</a></li></ul><ul><li><ul><li><a href=#solvecpp>solve.cpp</a></li><li><a href=#solvepy>solve.py</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&text=BambooFox%20CTF%202021" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&title=BambooFox%20CTF%202021" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&is_video=false&description=BambooFox%20CTF%202021" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=BambooFox%20CTF%202021&body=Check out this article: https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&title=BambooFox%20CTF%202021" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&title=BambooFox%20CTF%202021" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&name=BambooFox%20CTF%202021&description=%3ch1%20id%3d%22bamboofox-ctf-2021%22%3eBambooFox%20CTF%202021%3c%2fh1%3e%0a%3cp%3e%e9%80%99%e6%ac%a1%e6%98%af%e7%ac%ac%e4%ba%8c%e6%ac%a1%e5%8f%83%e5%8a%a0BambooFox%ef%bc%8c%e4%b8%8d%e9%81%8e%e4%ba%8b%e5%89%8d%e9%83%bd%e6%b2%92%e6%9c%89%e5%81%9a%e4%bb%80%e9%ba%bc%e7%b7%b4%e7%bf%92wwww%e6%9c%ac%e4%be%86%e6%83%b3%e8%aa%aa%e5%8e%bbOT%e4%b9%8b%e5%89%8d%e6%8e%a8%e8%96%a6%e9%81%8e%e7%9a%84%e7%b6%b2%e7%ab%99%e7%b7%b4%e7%bf%92%e4%b8%80%e4%ba%9b%e5%9f%ba%e7%a4%8e%ef%bc%8c%e4%bd%86%e6%98%af%e5%bf%98%e8%a8%98%e6%98%af%e4%bb%80%e9%ba%bc%e7%b6%b2%e7%ab%99%e4%ba%86888%3cbr%3e%0a%e4%be%9d%e7%84%b6%e6%98%af%e8%b7%9fjoy%e4%b8%80%e9%9a%8a%ef%bc%8c%e7%84%b6%e5%be%8c%e5%8f%a6%e4%b8%80%e5%80%8b%e9%9a%8a%e5%8f%8b%e8%ae%8a%e6%88%90casper%e4%ba%86%3c%2fp%3e%0a%3cp%3e%e4%bb%8a%e5%b9%b4%e4%bc%bc%e4%b9%8e%e6%98%af%e5%a4%a7%e9%80%b2%e6%ad%a5%ef%bc%8c%e4%b8%8d%e9%81%8e%e6%88%91%e6%87%b7%e7%96%91%e5%8f%aa%e6%98%af%e5%9b%a0%e7%82%ba%e8%80%83%e5%be%88%e5%a4%9a%e6%bc%94%e7%ae%97%e6%b3%95%e9%a1%8corz%3c%2fp%3e%0a%3cp%3e%e4%be%86%e8%ac%9b%e4%b8%80%e4%ba%9b%e6%9c%89%e8%a7%a3%e7%9a%84%e9%a1%8c%e7%9b%ae%ef%bc%8c%e5%be%88%e6%8a%b1%e6%ad%89%e6%88%91%e4%b8%8d%e7%9f%a5%e9%81%93%e6%80%8e%e9%ba%bc%e8%ae%93%e6%88%91%e7%9a%84code%e6%8a%98%e7%96%8a%e8%b5%b7%e4%be%86XD%3c%2fp%3e%0a%3ch2%20id%3d%22gamers-cipher%22%3eGamer%26rsquo%3bs%20Cipher%3c%2fh2%3e%0a%3cp%3e%e4%b8%80%e9%96%8b%e5%a0%b4%e5%85%88%e9%96%8b%e4%ba%86%20P%20versus%20%e2%99%afP%ef%bc%8c%e9%9b%96%e7%84%b6%e6%9f%a5%e5%88%b0%e8%a7%a3%e6%b3%95%e5%8f%af%e6%98%af%e7%b2%be%e5%ba%a6%e8%b7%9f%e9%80%9f%e5%ba%a6%e9%83%bd%e5%a3%93%e4%b8%8d%e9%81%8e%e5%8e%bb%ef%bc%8c%e6%89%80%e4%bb%a5%e5%8f%aa%e5%a5%bd%e6%94%be%e6%a3%84%e6%94%b9%e9%96%8b%e5%88%a5%e9%a1%8c%e3%80%82%3cbr%3e%0a%e7%84%b6%e5%be%8c%e7%ac%ac%e4%b8%80%e5%80%8b%e6%88%90%e5%8a%9f%e7%9a%84%e9%a1%8c%e7%9b%ae%e5%b0%b1%e6%98%afGamer%26rsquo%3bs%20Cipher%e9%80%99%e4%b8%80%e9%a1%8c%e3%80%82%3cbr%3e%0acasper%e8%aa%aa%e7%9c%8b%e6%87%82code%e5%b0%b1%e8%a7%a3%e5%ae%8c%e4%ba%86%ef%bc%88%ef%bc%9f%ef%bc%89%e4%b8%8d%e9%81%8e%e4%bb%96%e6%b2%92%e8%be%a6%e6%b3%95%e7%b7%a8%e8%ad%af%e6%89%80%e4%bb%a5%e4%b9%9f%e4%b8%8d%e7%9f%a5%e9%81%93%e6%80%8e%e9%ba%bc%e8%be%a6%e3%80%82%3cbr%3e%0a%e7%b8%bd%e4%b9%8b%e6%88%91%e4%b9%9f%e8%b7%91%e5%8e%bb%e4%b8%8b%e8%bc%89code%e7%9c%8b%ef%bc%8c%e7%84%b6%e5%be%8c%e6%9f%a5%e4%ba%86%e5%a5%bd%e4%b8%80%e4%b8%8b%e5%ad%90%e6%80%8e%e9%ba%bc%e7%b7%a8%e8%ad%afHaskell%ef%bc%88%e8%a8%98%e5%be%97%e7%b7%a8%e8%ad%af%e8%a6%81%e5%8a%a0%3ccode%3e-dynamic%3c%2fcode%3e%e7%9a%84flag%ef%bc%89%ef%bc%8c%e6%88%90%e5%8a%9f%e7%b7%a8%e8%ad%af%e4%b9%8b%e5%be%8c%e5%8a%aa%e5%8a%9b%e7%9c%8b%e6%87%82code%e3%80%82%3cbr%3e%0a%e7%9c%8b%e8%b5%b7%e4%be%86%e5%83%8f%e6%98%af%e7%94%a8%3ca%20href%3d%22https%3a%2f%2fen.wikipedia.org%2fwiki%2fNimber%22%3eNimber%3c%2fa%3e%e5%b0%8d%e5%ad%97%e4%b8%b2%e5%8a%a0%e5%af%86%ef%bc%8c%3cbr%3e%0a%e6%98%8e%e6%96%87%e5%92%8c%e5%af%86%e6%96%87%e7%9a%84%e9%95%b7%e5%ba%a6%e9%83%bd%e6%98%af%24n%3d51%24%ef%bc%8c%e7%84%b6%e5%be%8c%e4%bb%96%e7%9a%84key%e5%bf%85%e9%a0%88%e8%a6%81%e6%98%af%24n%24%e9%9a%8e%e7%9a%84%e5%8e%9f%e6%a0%b9%ef%bc%8c%e6%89%80%e4%bb%a5%e6%88%91%e5%af%ab%e4%ba%86%e4%b8%80%e5%80%8b%e8%85%b3%e6%9c%ac%e7%9c%8b%e5%93%aa%e4%ba%9b%e6%98%af%e5%90%88%e6%b3%95%e7%9a%84key%e3%80%82%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cdiv%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%0a%3ctable%20style%3d%22border-spacing%3a0%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%3ctr%3e%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e1%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e2%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e3%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e4%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e5%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e6%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e7%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e8%0a%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%0a%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%3bwidth%3a100%25%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-sh%22%20data-lang%3d%22sh%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%23%21%2fbin%2fbash%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%3c%2fspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%23%20search%20possible%20keys%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3elen%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23ae81ff%22%3e51%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3eprintf%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3blen%20%3d%20%25d%5cn%26%2334%3b%3c%2fspan%3e%20%24len%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3efor%3c%2fspan%3e%20i%20in%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3e%24%28%3c%2fspan%3eseq%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%20255%3cspan%20style%3d%22color%3a%2366d9ef%22%3e%29%3c%2fspan%3e%3b%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edo%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20echo%20%24i%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20printf%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b%2551s%5cn%25d%5cn%26%2334%3b%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%26%2339%3b%3c%2fspan%3e%20%24i%20%7c%20tr%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b%20%26%2334%3b%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3ba%26%2334%3b%3c%2fspan%3e%20%7c%20.%2fMain%202%26gt%3b%2fdev%2fnull%20%26gt%3b%2fdev%2fnull%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%26amp%3b%26amp%3b%3c%2fspan%3e%20printf%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bi%20%3d%20%25d%5cn%5cn%26%2334%3b%3c%2fspan%3e%20%24i%20%26gt%3b%26gt%3b%20possible.txt%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3edone%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%3c%2ftr%3e%3c%2ftable%3e%0a%3c%2fdiv%3e%0a%3c%2fdiv%3e%3cp%3e%e4%bd%86%e6%98%af%e9%97%9c%e9%8d%b5%e7%9a%84%e5%8a%a0%e5%af%86%e9%83%a8%e4%bb%bd%e6%80%8e%e9%ba%bc%e6%a8%a3%e9%83%bd%e4%b8%8d%e7%a2%ba%e5%ae%9a%e6%88%91%e7%9c%8b%e7%9a%84%e5%b0%8d%e4%b8%8d%e5%b0%8d%ef%bc%8c%e6%89%80%e4%bb%a5%e6%88%91%e5%85%88%e6%8a%8animber%e7%9a%84%e4%b9%98%e6%b3%95%e8%a1%a8%e5%bc%84%e6%88%90%e4%b8%80%e5%80%8b%e6%96%87%e5%ad%97%e6%aa%94%e5%ad%98%e8%b5%b7%e4%be%86%ef%bc%8c%e5%86%8d%e5%8f%a6%e5%a4%96%e5%af%ab%e4%b8%80%e5%80%8bpython%e8%b7%9fHaskell%e7%9a%84%e8%bc%b8%e5%87%ba%e6%af%94%e5%b0%8d%3cbr%3e%0a%e6%95%b4%e7%90%86%e4%b8%80%e4%b8%8b%e4%b9%8b%e5%be%8c%e7%99%bc%e7%8f%be%ef%bc%8c%e6%ac%b8%e9%80%99%e5%80%8b%e5%bc%8f%e5%ad%90%e4%b8%8d%e5%b0%b1%e6%98%af%e5%82%85%e7%ab%8b%e8%91%89%e8%bd%89%e6%8f%9b%e5%97%8e%ef%bc%9f%ef%bc%81%ef%bc%88%e8%80%8c%e4%b8%94%e9%82%84%e6%98%af%e7%94%a8Nimber%e5%81%9aDFT%ef%bc%8c%e9%85%b7%e7%88%86%ef%bc%89%e5%b0%b1%e6%83%b3%e8%aa%aa%e5%8f%af%e8%83%bd%e8%a6%81%e7%94%a8%e5%a4%9a%e9%a0%85%e5%bc%8f%e6%8f%92%e5%80%bc%e6%88%96%e6%98%af%e5%af%abinverse%20FFT%3cbr%3e%0a%e4%b9%8b%e5%be%8c%e7%94%a8python%e5%af%abinverse%20DFT%e5%af%ab%e6%8e%89%e4%ba%86%ef%bc%8c%e5%9f%ba%e6%9c%ac%e4%b8%8a%e5%8f%aa%e8%a6%81%e6%8a%8akey%e7%9a%84%e4%b9%98%e6%b3%95%e5%8f%8d%e5%85%83%e7%b4%a0%e6%89%be%e5%87%ba%e4%be%86%e5%b8%b6%e9%80%b2%e5%8e%bb%e5%82%85%e7%ab%8b%e8%91%89%e8%bd%89%e6%8f%9b%e7%9a%84%e5%bc%8f%e5%ad%90%e5%b0%b1%e5%a5%bd%e4%ba%86%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2021%2f01%2f19%2fbamboofox-ctf-2021%2f&t=BambooFox%20CTF%202021" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 Omelet</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/resources/>Resources</a></li><li><a href=/search/>Search</a></li><li><a href=/tags/>Tags</a></li></ul></nav></div></footer></div><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>$(function(){let e='<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!" style="z-index: 9999">';e+='<i class="far fa-clone"></i>',e+="</span>",$(".highlight table").before(e);const t=new ClipboardJS(".btn-copy",{text:function(e){const t='code[data-lang]:not([data-lang=""]) > span',n=Array.from(e.nextElementSibling.querySelectorAll(t)),s=n.map(e=>e.innerText).join("");return s}});t.on("success",function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()}),t.on("error",function(e){console.error("Action:",e.action),console.error("Trigger:",e.trigger)})})</script><button id=dark-mode-toggle-btn aria-label="Toggle dark mode">
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="sun" d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42M12 17.5a5.5 5.5.0 100-11 5.5 5.5.0 000 11z"/><path class="moon" d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
</button>
<script>function getSavedTheme(){return localStorage.getItem("theme")||"dark"}function saveTheme(e){localStorage.setItem("theme",e)}function applyTheme(e){document.documentElement.setAttribute("data-theme",e)}function toggleTheme(){const t=getSavedTheme(),e=t==="dark"?"white":"dark";applyTheme(e),saveTheme(e)}applyTheme(getSavedTheme()),window.addEventListener("storage",function(e){e.key==="theme"&&applyTheme(e.newValue)})</script><script type=text/javascript src=/js/canvas-nest.js></script><canvas id=bganim-canvas></canvas>
<button id=bganim-toggle-btn aria-label="Toggle background animation">
<svg width="30" height="25" viewBox="0 0 200 200"><polygon class="hexagon" points="100,20 170,60 170,140 100,180 30,140 30,60" fill="none" stroke="currentColor" stroke-width="15"/></svg>
</button>
<script>let movingPoints=null;function initMovingPoints(){if(movingPoints!==null)return;movingPoints=createMovingPoints({canvas:document.getElementById("bganim-canvas"),config:{count:90,color:"0,200,100",opacity:.5}})}function getSavedEnabledState(){const e=localStorage.getItem("bganim-enabled"),t=window.innerWidth>=480,n=e==="true";return e===null?t:n}function saveEnabledState(e){localStorage.setItem("bganim-enabled",e)}function applyEnabledState(e){document.documentElement.setAttribute("data-bganim-enabled",e),e?(initMovingPoints(),movingPoints.startAnimation()):movingPoints!==null&&movingPoints.stopAnimation()}function toggleEnabledState(){const t=getSavedEnabledState(),e=!t;applyEnabledState(e),saveEnabledState(e)}applyEnabledState(getSavedEnabledState()),window.addEventListener("storage",function(e){e.key==="theme"&&applyEnabledState(e.newValue==="true")})</script><script>$("#nav > ul").append("<li></li>"),$("#dark-mode-toggle-btn").appendTo("#nav > ul > li:last-child"),$("#dark-mode-toggle-btn").click(toggleTheme),$("#bganim-toggle-btn").appendTo("#nav > ul > li:last-child"),$("#bganim-toggle-btn").click(toggleEnabledState)</script></body></html>