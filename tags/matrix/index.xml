<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Matrix on 蛋餅的競程隨筆</title><link>https://omeletwithoutegg.github.io/tags/matrix/</link><description>Recent content in Matrix on 蛋餅的競程隨筆</description><generator>Hugo</generator><language>en-us</language><copyright>Omelet</copyright><lastBuildDate>Sat, 01 Feb 2025 02:47:28 +0800</lastBuildDate><atom:link href="https://omeletwithoutegg.github.io/tags/matrix/index.xml" rel="self" type="application/rss+xml"/><item><title>求解二維網格圖上的線性方程組：關鍵變數法</title><link>https://omeletwithoutegg.github.io/2025/02/01/grid-linear-system/</link><pubDate>Sat, 01 Feb 2025 02:47:28 +0800</pubDate><guid>https://omeletwithoutegg.github.io/2025/02/01/grid-linear-system/</guid><description>&lt;h1 id="關鍵變數法">關鍵變數法&lt;/h1>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>上個例題 &lt;a href="https://codeforces.com/problemset/problem/963/E">https://codeforces.com/problemset/problem/963/E&lt;/a>&lt;/p>
&lt;p>有一個人在二維網格圖上隨機上下左右走，一開始在原點 $(0, 0)$，每秒有 $p_1, p_2, p_3, p_4$ 的機率分別往上下左右走一格，問期望幾秒會走到跟原點距離超過 $r$ 的點？答案模 $10^9+7$。$p_i = a_i/\sum a_i$ 而 $1 \leq a_i \leq 1000$。&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;p>令 $f(i, j)$ 代表期望走幾步會停下來，則邊界的 $f(i, j) = 0$，而對於內部的 $f(i, j)$ 則有&lt;/p>
&lt;p>$$&lt;br>
f(i, j) = 1 + p_1 f(i - 1, j) + p_2 f(i + 1, j) + p_3 f(i, j - 1) + p_4 f(i, j + 1)&lt;br>
$$&lt;/p>
&lt;p>因為變數之間依賴的關係有環所以不能簡單的用 DP 求解。高斯消去要花 $\mathcal{O}(n^3)$ 的時間求解，其中 $n$ 是變數數量，也就是大約 $\pi r^3$ 個，所以總共是 $\mathcal{O}(r^6)$。官解是利用類似 band matrix 的性質做到 $\mathcal{O}(r^4)$。&lt;/p></description></item><item><title>Multipoint Evaluation of Prefix Products</title><link>https://omeletwithoutegg.github.io/2025/01/09/multipoint-evaluation-of-prefix-products/</link><pubDate>Thu, 09 Jan 2025 23:10:09 +0800</pubDate><guid>https://omeletwithoutegg.github.io/2025/01/09/multipoint-evaluation-of-prefix-products/</guid><description>&lt;h1 id="一次式前綴積的多點求值與推廣">一次式前綴積的多點求值與推廣&lt;/h1>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>給定序列 $a_1, \dots, a_N$。考慮一次式的序列 $x - a_i$，定義其第 $i$ 個前綴積為&lt;/p>
&lt;p>$$&lt;br>
f_i(x) = \prod _ {j \leq i} (x - a_j)&lt;br>
$$&lt;/p>
&lt;p>接著有 $Q$ 個詢問 $(u_i, v_i)$ 要你回答第 $u_i$ 個前綴積以 $x = v_i$ 代入所得到的值，即 $f_{u_i}(v_i)$。&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;p>naive 可以做到 $\mathcal{O}(NQ)$。以下介紹一個 $\mathcal{O}((N+Q)\log^2(N+Q))$ 的離線作法。&lt;/p>
&lt;p>先問一個問題：我們要怎麼快速的求出 $f_N(x)$ 這個多項式呢？如果用 $f_i(x) = f_{i-1}(x) \cdot (x - a_i)$ 每次直接 $\mathcal{O}(N)$ 乘的話，總共會花上 $\mathcal{O}(N^2)$ 的時間。然而，我們可以建出一棵平衡的二元樹，樹的葉子是這些一次式，如果按照由下到上的順序計算每個節點的小孩的乘積，並使用 FFT 等比較快的多項式乘法的話，總時間就會是 $\mathcal{O}(N\log^2N)$。這是因為使用 FFT 把兩個多項式 $f, g$ 相乘會需要 $\mathcal{O}(k\log k)$ 的時間，其中 $k=\deg (fg)$；而在這棵二元樹中每個節點所存的多項式 degree 會等於該節點的子樹裡面的葉子數量，所有節點的多項式 degree 總和又更進一步的等於每個葉子的深度和（可以想想為什麼），因此只要二元樹夠平衡，深度是 $\mathcal{O}(\log N)$ 的話，總共乘法所需的時間就會是 $\mathcal{O}(N\log ^2N)$。&lt;/p></description></item><item><title>TIOJ-2021</title><link>https://omeletwithoutegg.github.io/2019/12/04/tioj-2021/</link><pubDate>Wed, 04 Dec 2019 11:34:34 +0000</pubDate><guid>https://omeletwithoutegg.github.io/2019/12/04/tioj-2021/</guid><description>&lt;h1 id="f無限兔子問題">F.無限兔子問題&lt;/h1>
&lt;p>&lt;a href="https://tioj.ck.tp.edu.tw/problems/2021">https://tioj.ck.tp.edu.tw/problems/2021&lt;/a>&lt;/p>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>令$F_i$是費式數列&lt;br>
給定$s,t$，求$\sum\limits _ {i=s}^t\binom{F_i}{2}$&lt;/p>
&lt;h2 id="solution">Solution&lt;/h2>
&lt;p>這題也是有夠數學OwO&lt;br>
題目所求是$\sum\limits _ {i=s}^t\frac{1}{2}{F_i(F_i - 1)}$&lt;br>
可以想到分別求$\sum\limits _ {i=1}^nF_i$和$\sum\limits _ {i=1}^nF_i^2$&lt;/p>
&lt;p>前者可以用&lt;br>
$$&lt;br>
\left[&lt;br>
\begin{matrix}&lt;br>
0 &amp;amp; 1 &amp;amp; 0 \newline&lt;br>
1 &amp;amp; 1 &amp;amp; 0 \newline&lt;br>
1 &amp;amp; 1 &amp;amp; 1&lt;br>
\end{matrix}&lt;br>
\right]&lt;br>
\left[&lt;br>
\begin{matrix}&lt;br>
F _ {i-2} \newline&lt;br>
F _ {i-1} \newline&lt;br>
S _ {i-1}&lt;br>
\end{matrix}&lt;br>
\right] =&lt;br>
\left[&lt;br>
\begin{matrix}&lt;br>
F _ {i-1} \newline&lt;br>
F_i \newline&lt;br>
S_i&lt;br>
\end{matrix}&lt;br>
\right]&lt;br>
$$&lt;br>
來得到前綴$S_i$的值&lt;/p></description></item></channel></rss>